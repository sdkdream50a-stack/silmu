<%= turbo_frame_tag "search-results" do %>
  <div class="max-w-4xl mx-auto px-4 mt-8">
    <% if @query.present? %>
      <!-- ê²€ìƒ‰ ê²°ê³¼ í—¤ë” -->
      <div class="mb-6">
        <h2 class="text-lg font-semibold text-gray-800">
          "<%= @query %>" ê²€ìƒ‰ ê²°ê³¼
        </h2>
      </div>

      <!-- í† í”½ ë§¤ì¹­ ê²°ê³¼ (ë²•ë ¹ ê°€ì´ë“œ) -->
      <% if @topic %>
        <div class="mb-6">
          <%= link_to topic_path(@topic.slug), class: "block bg-white border-2 border-indigo-500 rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow", data: { turbo_frame: "_top" } do %>
            <div class="flex items-start justify-between">
              <div>
                <div class="flex items-center gap-2 mb-2">
                  <span class="px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded text-xs font-medium">ğŸ“š ë²•ë ¹ ê°€ì´ë“œ</span>
                </div>
                <h3 class="text-xl font-bold mb-2 text-gray-900"><%= @topic.name %></h3>
                <p class="text-gray-600 text-sm line-clamp-2"><%= @topic.summary %></p>
                <div class="mt-3 flex flex-wrap gap-2">
                  <span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded">ğŸ“œ ë²•ë ¹ 3ë‹¨ ë¹„êµ</span>
                  <span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded">ğŸ“‹ ì˜ˆê·œ/ì§€ì¹¨</span>
                  <span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded">âš–ï¸ ìœ ê¶Œí•´ì„</span>
                  <span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded">âš ï¸ ì‹¤ë¬´ì£¼ì˜</span>
                </div>
              </div>
              <svg class="w-6 h-6 flex-shrink-0 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </div>
          <% end %>
        </div>
      <% end %>

      <% if @topic && @topic.faq_list.any? %>
        <!-- ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (ì•„ì½”ë””ì–¸) -->
        <div class="bg-white rounded-xl shadow p-6">
          <h3 class="text-lg font-bold mb-4">â“ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</h3>
          <div class="space-y-2" id="search-faq-accordion">
            <% @topic.faq_list.first(5).each_with_index do |faq, index| %>
              <div class="border border-gray-200 rounded-lg overflow-hidden">
                <button onclick="toggleSearchFaq(<%= index %>)"
                        class="w-full px-4 py-3 text-left bg-gray-50 hover:bg-gray-100 flex items-center justify-between transition-colors">
                  <span class="font-medium text-gray-800">Q. <%= faq['question'] %></span>
                  <svg id="search-faq-icon-<%= index %>" class="w-5 h-5 text-gray-500 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                  </svg>
                </button>
                <div id="search-faq-answer-<%= index %>" class="hidden px-4 py-3 bg-white border-t border-gray-200">
                  <p class="text-gray-700 whitespace-pre-line"><%= faq['answer'] %></p>
                </div>
              </div>
            <% end %>
          </div>
          <% if @topic.faq_list.size > 5 %>
            <div class="mt-4 text-center">
              <%= link_to "ë” ë³´ê¸° â†’", topic_path(@topic.slug), class: "text-indigo-600 hover:text-indigo-800 font-medium", data: { turbo_frame: "_top" } %>
            </div>
          <% end %>
        </div>

        <script>
        function toggleSearchFaq(index) {
          const answer = document.getElementById(`search-faq-answer-${index}`);
          const icon = document.getElementById(`search-faq-icon-${index}`);
          if (answer.classList.contains('hidden')) {
            answer.classList.remove('hidden');
            icon.classList.add('rotate-180');
          } else {
            answer.classList.add('hidden');
            icon.classList.remove('rotate-180');
          }
        }
        </script>
      <% elsif @topic.nil? %>
        <!-- ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ -->
        <div class="bg-white rounded-xl shadow p-8 text-center">
          <div class="text-6xl mb-4">ğŸ”</div>
          <h3 class="text-lg font-medium text-gray-800 mb-2">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
          <p class="text-gray-500 mb-4">ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”</p>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>
