<%# ê³„ì•½ë°©ì‹ ê²°ì • ë„êµ¬ - ê¸ˆì•¡/ìœ í˜•ë³„ ì ì • ê³„ì•½ë°©ì‹ ì•ˆë‚´ %>

<style>
  .method-tool {
    max-width: 900px;
    margin: 0 auto;
  }

  /* ì…ë ¥ ì¹´ë“œ */
  .input-card {
    background: white;
    border-radius: 20px;
    padding: 32px;
    box-shadow: 0 4px 24px rgba(0,0,0,0.06);
    border: 1px solid #e2e8f0;
    margin-bottom: 24px;
  }
  .input-card h2 {
    font-size: 20px;
    font-weight: 700;
    color: var(--navy-900);
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .input-card .subtitle {
    color: #64748b;
    font-size: 14px;
    margin-bottom: 28px;
  }

  /* ê³„ì•½ ìœ í˜• ì„ íƒ */
  .type-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin-bottom: 28px;
  }
  .type-option {
    padding: 12px 14px;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s ease;
    background: white;
  }
  .type-option:hover {
    border-color: #4ade80;
    background: #f0fdf4;
  }
  .type-option.selected {
    border-color: #16a34a;
    background: #f0fdf4;
    box-shadow: 0 0 0 3px rgba(47, 129, 50, 0.15);
  }
  .type-option .material-symbols-outlined {
    font-size: 24px;
    color: #64748b;
    margin-bottom: 4px;
    display: block;
  }
  .type-option.selected .material-symbols-outlined {
    color: #16a34a;
  }
  .type-option .name {
    font-weight: 600;
    color: #1e293b;
    font-size: 13px;
  }

  /* ê¸ˆì•¡ ì…ë ¥ */
  .amount-section {
    margin-bottom: 24px;
  }
  .amount-section label {
    display: block;
    font-weight: 600;
    color: var(--navy-800);
    margin-bottom: 10px;
    font-size: 15px;
  }
  .amount-input-wrap {
    position: relative;
  }
  .amount-input-wrap input {
    width: 100%;
    padding: 18px 80px 18px 24px;
    border: 2px solid #e2e8f0;
    border-radius: 14px;
    font-size: 24px;
    font-weight: 700;
    color: #1e293b;
    background: #fff;
    transition: all 0.2s;
    text-align: right;
  }
  .amount-input-wrap input::placeholder {
    color: #94a3b8;
  }
  .amount-input-wrap input:focus {
    outline: none;
    border-color: var(--forest-500);
    box-shadow: 0 0 0 3px rgba(47, 129, 50, 0.15);
  }
  .amount-input-wrap .unit {
    position: absolute;
    right: 24px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 18px;
    color: #64748b;
    font-weight: 500;
  }
  .amount-hint {
    margin-top: 10px;
    font-size: 13px;
    color: #64748b;
  }
  .quick-amounts {
    display: flex;
    gap: 8px;
    margin-top: 12px;
    align-items: center;
  }
  .quick-amount {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 8px 14px;
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 20px;
    font-size: 13px;
    color: #334155;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }
  .quick-amount:hover {
    background: var(--forest-50);
    border-color: var(--forest-300);
    color: var(--forest-700);
  }
  .quick-amount.reset-btn {
    background: #fef3c7;
    border-color: #fcd34d;
    color: #b45309;
    margin-left: 150px;
  }
  .quick-amount.reset-btn:hover {
    background: #fde68a;
    border-color: #f59e0b;
    color: #92400e;
  }

  /* íŠ¹ë¡€ê¸°ì—… ì„ íƒ */
  .special-section {
    padding: 20px;
    background: var(--surface-50);
    border-radius: 14px;
    border: 1px solid #e2e8f0;
    margin-bottom: 24px;
  }
  .special-section summary {
    cursor: pointer;
    font-weight: 600;
    color: var(--navy-800);
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .special-section summary .material-symbols-outlined {
    font-size: 20px;
    color: var(--warm-600);
  }
  .special-options {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 16px;
  }
  .special-option {
    padding: 10px 16px;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
    background: white;
  }
  .special-option:hover {
    border-color: var(--warm-400);
  }
  .special-option.selected {
    border-color: var(--warm-500);
    background: var(--warm-50);
    color: var(--warm-700);
    font-weight: 600;
  }

  /* ê²°ì • ë²„íŠ¼ */
  .determine-btn {
    width: 100%;
    padding: 18px;
    background: linear-gradient(135deg, #16a34a, #22c55e);
    color: #ffffff !important;
    border: none;
    border-radius: 14px;
    font-size: 17px;
    font-weight: 700;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.2s;
  }
  .determine-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(47, 129, 50, 0.3);
  }
  .determine-btn:disabled {
    background: #cbd5e1;
    color: #64748b !important;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  /* ê²°ê³¼ ì¹´ë“œ */
  .result-card {
    background: white;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0,0,0,0.08);
    border: 1px solid #e2e8f0;
    display: none;
  }
  .result-card.show {
    display: block;
    animation: slideUp 0.4s ease;
  }
  @keyframes slideUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .result-header {
    padding: 32px;
    text-align: center;
  }
  .result-header.ì…ì°° {
    background: linear-gradient(135deg, var(--point-600), var(--point-500));
    color: white;
  }
  .result-header.ìˆ˜ì˜ê³„ì•½ {
    background: linear-gradient(135deg, var(--forest-600), var(--forest-500));
    color: white;
  }
  .result-header.ì†Œì•¡ìˆ˜ì˜ê³„ì•½ {
    background: linear-gradient(135deg, var(--navy-700), var(--navy-600));
    color: white;
  }
  .result-method {
    font-size: 14px;
    opacity: 0.9;
    margin-bottom: 8px;
  }
  .result-method-main {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 4px;
  }
  .result-method-detail {
    font-size: 16px;
    opacity: 0.9;
  }

  .result-body {
    padding: 28px;
  }

  /* ì •ë³´ ë°•ìŠ¤ */
  .info-box {
    padding: 20px;
    background: var(--surface-50);
    border-radius: 14px;
    margin-bottom: 20px;
  }
  .info-box h4 {
    font-size: 14px;
    font-weight: 600;
    color: var(--navy-800);
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .info-box h4 .material-symbols-outlined {
    font-size: 20px;
    color: var(--navy-500);
  }
  .info-row {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px solid #e2e8f0;
    font-size: 14px;
  }
  .info-row:last-child {
    border-bottom: none;
  }
  .info-row .label {
    color: #64748b;
  }
  .info-row .value {
    font-weight: 600;
    color: var(--navy-900);
  }

  /* ë²•ë ¹ ê·¼ê±° */
  .basis-box {
    padding: 16px 20px;
    background: var(--point-50);
    border-left: 4px solid var(--point-500);
    border-radius: 0 12px 12px 0;
    margin-bottom: 20px;
  }
  .basis-box .title {
    font-size: 12px;
    color: var(--point-700);
    font-weight: 600;
    margin-bottom: 6px;
  }
  .basis-box .content {
    font-size: 14px;
    color: var(--navy-800);
  }

  /* ê²½ê³ /ì•ˆë‚´ ë°•ìŠ¤ */
  .alert-box {
    padding: 16px 20px;
    border-radius: 12px;
    margin-bottom: 12px;
    display: flex;
    align-items: flex-start;
    gap: 12px;
  }
  .alert-box.warning {
    background: var(--warm-50);
    border: 1px solid var(--warm-200);
  }
  .alert-box.warning .material-symbols-outlined {
    color: var(--warm-600);
  }
  .alert-box.info {
    background: var(--point-50);
    border: 1px solid var(--point-200);
  }
  .alert-box.info .material-symbols-outlined {
    color: var(--point-600);
  }
  .alert-box .content h5 {
    font-size: 14px;
    font-weight: 600;
    color: var(--navy-900);
    margin-bottom: 4px;
  }
  .alert-box .content p {
    font-size: 13px;
    color: var(--navy-700);
    margin: 0;
  }
  .alert-box .content a {
    color: var(--point-600);
    text-decoration: underline;
    font-size: 12px;
  }

  /* í•„ìš” ì„œë¥˜ */
  .documents-section {
    margin-top: 24px;
  }
  .documents-section h4 {
    font-size: 15px;
    font-weight: 600;
    color: var(--navy-800);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .doc-list {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
  }
  .doc-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 14px 16px;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 10px;
    font-size: 14px;
    color: var(--navy-800);
  }
  .doc-item .material-symbols-outlined {
    font-size: 20px;
    color: var(--forest-500);
  }

  /* íŒ ì„¹ì…˜ */
  .tips-section {
    margin-top: 24px;
    padding: 20px;
    background: linear-gradient(135deg, var(--navy-50), white);
    border-radius: 14px;
    border: 1px solid var(--navy-100);
  }
  .tips-section h4 {
    font-size: 14px;
    font-weight: 600;
    color: var(--navy-800);
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .tips-section h4 .material-symbols-outlined {
    color: var(--warm-500);
  }
  .tip-item {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--navy-700);
    line-height: 1.5;
  }
  .tip-item::before {
    content: "ğŸ’¡";
    font-size: 14px;
    flex-shrink: 0;
  }

  /* ê´€ë ¨ ë§í¬ */
  .links-section {
    margin-top: 24px;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }
  .link-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 20px;
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    color: var(--navy-700);
    text-decoration: none;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s;
  }
  .link-btn:hover {
    border-color: var(--navy-400);
    background: var(--surface-50);
  }
  .link-btn .material-symbols-outlined {
    font-size: 20px;
  }

  /* ë‹¤ì‹œí•˜ê¸° ë²„íŠ¼ */
  .reset-btn {
    width: 100%;
    margin-top: 20px;
    padding: 16px;
    background: var(--surface-100);
    color: var(--navy-700);
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.2s;
  }
  .reset-btn:hover {
    background: var(--surface-200);
  }

  /* ë°˜ì‘í˜• */
  @media (max-width: 768px) {
    .type-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    .doc-list {
      grid-template-columns: 1fr;
    }
    .links-section {
      flex-direction: column;
    }
    .link-btn {
      justify-content: center;
    }
  }

  /* ì¸ì‡„ */
  @media print {
    .input-card, .reset-btn {
      display: none !important;
    }
    .result-card {
      box-shadow: none;
      border: 1px solid #333;
    }
  }
</style>

<!-- í˜ì´ì§€ í—¤ë” -->
<section class="gradient-forest text-white py-12 lg:py-16">
  <div class="container-wide">
    <div class="flex items-start gap-5">
      <div class="w-16 h-16 bg-white/10 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/20 shadow-lg">
        <span class="material-symbols-outlined text-4xl text-white">gavel</span>
      </div>
      <div>
        <h1 class="text-3xl lg:text-4xl font-bold tracking-tight mb-2">ê³„ì•½ë°©ì‹ ê²°ì • ë„ìš°ë¯¸</h1>
        <p class="text-forest-100 text-lg">ì¶”ì •ê°€ê²©ê³¼ ê³„ì•½ìœ í˜•ìœ¼ë¡œ ì ì • ê³„ì•½ë°©ì‹ì„ í™•ì¸í•˜ì„¸ìš”</p>
      </div>
    </div>
  </div>
</section>

<section class="section py-10">
  <div class="container-wide method-tool">
    <!-- ì…ë ¥ í¼ -->
    <div class="input-card" id="input-section">
      <h2>
        <span class="material-symbols-outlined">edit_note</span>
        ê³„ì•½ ì •ë³´ ì…ë ¥
      </h2>
      <p class="subtitle">ê³„ì•½ ìœ í˜•ê³¼ ì¶”ì •ê°€ê²©ì„ ì…ë ¥í•˜ë©´ ì ì • ê³„ì•½ë°©ì‹ê³¼ í•„ìš” ì„œë¥˜ë¥¼ ì•ˆë‚´í•´ë“œë¦½ë‹ˆë‹¤</p>

      <!-- ê³„ì•½ ìœ í˜• ì„ íƒ -->
      <div class="type-grid">
        <% [
          { key: "goods", name: "ë¬¼í’ˆ", icon: "inventory_2" },
          { key: "service", name: "ìš©ì—­", icon: "support_agent" },
          { key: "construction_general", name: "ì¢…í•©ê³µì‚¬", icon: "domain" },
          { key: "construction_special", name: "ì „ë¬¸ê³µì‚¬", icon: "engineering" },
          { key: "construction_etc", name: "ì „ê¸°/ì†Œë°©/ì •ë³´í†µì‹ ", icon: "electrical_services" }
        ].each do |type| %>
          <div class="type-option" data-type="<%= type[:key] %>" onclick="selectType('<%= type[:key] %>')">
            <span class="material-symbols-outlined"><%= type[:icon] %></span>
            <span class="name"><%= type[:name] %></span>
          </div>
        <% end %>
      </div>

      <!-- ì¶”ì •ê°€ê²© ì…ë ¥ -->
      <div class="amount-section">
        <label>ì¶”ì •ê°€ê²© (ë¶€ê°€ì„¸ ì œì™¸)</label>
        <div class="amount-input-wrap">
          <input type="text" id="estimated-price" placeholder="0" oninput="formatPrice(this)">
          <span class="unit">ì›</span>
        </div>
        <p class="amount-hint">ì„¤ê³„ê¸ˆì•¡ ë˜ëŠ” ì˜ˆì •ê°€ê²© ì‘ì„± ì „ ëŒ€ëµì ì¸ ì˜ˆìƒ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”</p>
        <div class="quick-amounts">
          <span class="quick-amount" onclick="setQuickAmount(10000000)">1ì²œë§Œì›</span>
          <span class="quick-amount" onclick="setQuickAmount(30000000)">3ì²œë§Œì›</span>
          <span class="quick-amount" onclick="setQuickAmount(50000000)">5ì²œë§Œì›</span>
          <span class="quick-amount" onclick="setQuickAmount(100000000)">1ì–µì›</span>
          <span class="quick-amount" onclick="setQuickAmount(200000000)">2ì–µì›</span>
          <span class="quick-amount" onclick="setQuickAmount(500000000)">5ì–µì›</span>
          <span class="quick-amount reset-btn" onclick="resetAmount()">ì´ˆê¸°í™”</span>
        </div>
      </div>

      <!-- íŠ¹ë¡€ê¸°ì—… ì„ íƒ -->
      <details class="special-section">
        <summary>
          <span class="material-symbols-outlined">star</span>
          íŠ¹ë¡€ê¸°ì—… ì—¬ë¶€ (ì—¬ì„±ê¸°ì—…, ì‚¬íšŒì ê¸°ì—… ë“±)
        </summary>
        <div class="special-options">
          <span class="special-option" data-special="none" onclick="selectSpecial('none')">í•´ë‹¹ì—†ìŒ</span>
          <span class="special-option" data-special="women" onclick="selectSpecial('women')">ì—¬ì„±ê¸°ì—…</span>
          <span class="special-option" data-special="disabled" onclick="selectSpecial('disabled')">ì¥ì• ì¸ê¸°ì—…</span>
          <span class="special-option" data-special="social" onclick="selectSpecial('social')">ì‚¬íšŒì ê¸°ì—…</span>
          <span class="special-option" data-special="cooperative" onclick="selectSpecial('cooperative')">í˜‘ë™ì¡°í•©</span>
          <span class="special-option" data-special="village" onclick="selectSpecial('village')">ë§ˆì„ê¸°ì—…</span>
          <span class="special-option" data-special="self_support" onclick="selectSpecial('self_support')">ìí™œê¸°ì—…</span>
        </div>
      </details>

      <button class="determine-btn" onclick="determineMethod()" id="determine-btn" disabled>
        <span class="material-symbols-outlined">search</span>
        ê³„ì•½ë°©ì‹ í™•ì¸í•˜ê¸°
      </button>
    </div>

    <!-- ê²°ê³¼ ì¹´ë“œ -->
    <div class="result-card" id="result-section">
      <div class="result-header" id="result-header">
        <div class="result-method">ì¶”ì²œ ê³„ì•½ë°©ì‹</div>
        <div class="result-method-main" id="result-method"></div>
        <div class="result-method-detail" id="result-detail"></div>
      </div>

      <div class="result-body">
        <!-- ê¸°ë³¸ ì •ë³´ -->
        <div class="info-box">
          <h4>
            <span class="material-symbols-outlined">info</span>
            ì…ë ¥ ì •ë³´
          </h4>
          <div class="info-row">
            <span class="label">ê³„ì•½ ìœ í˜•</span>
            <span class="value" id="info-type"></span>
          </div>
          <div class="info-row">
            <span class="label">ì¶”ì •ê°€ê²©</span>
            <span class="value" id="info-price"></span>
          </div>
          <div class="info-row" id="info-special-row" style="display: none;">
            <span class="label">íŠ¹ë¡€ ì ìš©</span>
            <span class="value" id="info-special"></span>
          </div>
        </div>

        <!-- ë²•ë ¹ ê·¼ê±° -->
        <div class="basis-box">
          <div class="title">ë²•ë ¹ ê·¼ê±°</div>
          <div class="content" id="basis-content"></div>
        </div>

        <!-- ê²½ê³ /ì•ˆë‚´ -->
        <div id="warnings-container"></div>

        <!-- í•„ìš” ì„œë¥˜ -->
        <div class="documents-section">
          <h4>
            <span class="material-symbols-outlined">description</span>
            í•„ìš” ì„œë¥˜
          </h4>
          <div class="doc-list" id="doc-list"></div>
        </div>

        <!-- íŒ -->
        <div class="tips-section">
          <h4>
            <span class="material-symbols-outlined">tips_and_updates</span>
            ì‹¤ë¬´ íŒ
          </h4>
          <div id="tips-container"></div>
        </div>

        <!-- ê´€ë ¨ ë§í¬ -->
        <div class="links-section">
          <a href="https://www.g2b.go.kr" target="_blank" class="link-btn">
            <span class="material-symbols-outlined">open_in_new</span>
            ë‚˜ë¼ì¥í„°
          </a>
          <a href="https://www.s2b.kr" target="_blank" class="link-btn">
            <span class="material-symbols-outlined">open_in_new</span>
            í•™êµì¥í„°
          </a>
          <a href="https://www.smpp.go.kr" target="_blank" class="link-btn">
            <span class="material-symbols-outlined">open_in_new</span>
            ì¤‘ì†Œê¸°ì—…ì œí’ˆ ê³µê³µêµ¬ë§¤
          </a>
          <%= link_to contract_documents_path, class: "link-btn" do %>
            <span class="material-symbols-outlined">checklist</span>
            ì„œë¥˜ ì²´í¬ë¦¬ìŠ¤íŠ¸
          <% end %>
        </div>

        <button class="reset-btn" onclick="resetForm()">
          <span class="material-symbols-outlined">refresh</span>
          ë‹¤ì‹œ í™•ì¸í•˜ê¸°
        </button>
      </div>
    </div>
  </div>
</section>

<script>
  let selectedType = null;
  let selectedSpecial = null;
  let estimatedPrice = 0;

  function selectType(type) {
    selectedType = type;
    document.querySelectorAll('.type-option').forEach(el => {
      el.classList.toggle('selected', el.dataset.type === type);
    });
    checkFormValid();
  }

  function selectSpecial(special) {
    selectedSpecial = special === 'none' ? null : special;
    document.querySelectorAll('.special-option').forEach(el => {
      el.classList.toggle('selected', el.dataset.special === special);
    });
  }

  function formatPrice(input) {
    let value = input.value.replace(/[^0-9]/g, '');
    if (value) {
      estimatedPrice = parseInt(value);
      input.value = estimatedPrice.toLocaleString('ko-KR');
    } else {
      estimatedPrice = 0;
    }
    checkFormValid();
  }

  function setQuickAmount(amount) {
    estimatedPrice = amount;
    document.getElementById('estimated-price').value = amount.toLocaleString('ko-KR');
    checkFormValid();
  }

  function resetAmount() {
    estimatedPrice = 0;
    document.getElementById('estimated-price').value = '';
    checkFormValid();
  }

  function checkFormValid() {
    const btn = document.getElementById('determine-btn');
    btn.disabled = !(selectedType && estimatedPrice > 0);
  }

  async function determineMethod() {
    if (!selectedType || estimatedPrice <= 0) return;

    try {
      const response = await fetch('/contract-methods/determine', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRF-Token': document.querySelector('[name="csrf-token"]')?.content || ''
        },
        body: JSON.stringify({
          contract_type: selectedType,
          estimated_price: estimatedPrice,
          special_enterprise: selectedSpecial
        })
      });

      const result = await response.json();

      if (result.success) {
        renderResult(result);
      } else {
        alert(result.error || 'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    } catch (error) {
      console.error('Error:', error);
      alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
  }

  function renderResult(result) {
    // í—¤ë” ìƒ‰ìƒ ì„¤ì •
    const header = document.getElementById('result-header');
    header.className = 'result-header ' + result.result.method;

    // ê³„ì•½ë°©ì‹ í‘œì‹œ
    document.getElementById('result-method').textContent = result.result.method;
    document.getElementById('result-detail').textContent = result.result.method_detail;

    // ê¸°ë³¸ ì •ë³´
    document.getElementById('info-type').textContent = result.contract_type.name;
    document.getElementById('info-price').textContent = result.formatted_price + 'ì›';

    // íŠ¹ë¡€ ì ìš©
    const specialRow = document.getElementById('info-special-row');
    if (result.result.special_applied && result.special_enterprise) {
      specialRow.style.display = 'flex';
      document.getElementById('info-special').textContent = result.special_enterprise.name + ' íŠ¹ë¡€';
    } else {
      specialRow.style.display = 'none';
    }

    // ë²•ë ¹ ê·¼ê±°
    document.getElementById('basis-content').textContent = result.result.basis;

    // ê²½ê³ /ì•ˆë‚´
    const warningsHtml = result.warnings.map(w => `
      <div class="alert-box ${w.level}">
        <span class="material-symbols-outlined">${w.level === 'warning' ? 'warning' : 'info'}</span>
        <div class="content">
          <h5>${w.title}</h5>
          <p>${w.message}</p>
          ${w.link ? `<a href="${w.link}" target="_blank">ìì„¸íˆ ë³´ê¸° â†’</a>` : ''}
        </div>
      </div>
    `).join('');

    // íŠ¹ë³„ ì¡°ê±´ ì¶”ê°€
    if (result.result.special_condition) {
      document.getElementById('warnings-container').innerHTML = `
        <div class="alert-box info">
          <span class="material-symbols-outlined">lightbulb</span>
          <div class="content">
            <h5>ì°¸ê³ ì‚¬í•­</h5>
            <p>${result.result.special_condition}</p>
          </div>
        </div>
      ` + warningsHtml;
    } else {
      document.getElementById('warnings-container').innerHTML = warningsHtml;
    }

    // í•„ìš” ì„œë¥˜
    const docsHtml = result.result.documents.map(doc => `
      <div class="doc-item">
        <span class="material-symbols-outlined">description</span>
        ${doc}
      </div>
    `).join('');
    document.getElementById('doc-list').innerHTML = docsHtml;

    // íŒ
    const tipsHtml = result.tips.map(tip => `
      <div class="tip-item">${tip}</div>
    `).join('');
    document.getElementById('tips-container').innerHTML = tipsHtml;

    // ê²°ê³¼ í‘œì‹œ
    document.getElementById('result-section').classList.add('show');
    document.getElementById('result-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  function resetForm() {
    document.getElementById('result-section').classList.remove('show');
    document.getElementById('input-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  // ì´ˆê¸°í™”
  selectSpecial('none');
</script>
