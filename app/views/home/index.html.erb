<%# Stitch 디자인 v2 — Indigo/Violet 프리미엄 테마 (컴파일 CSS 사용) %>

<div class="font-sans text-slate-800 antialiased selection:bg-indigo-500/30 selection:text-indigo-600">

<!-- Hero Section -->
<div class="relative w-full hero-gradient overflow-hidden pb-24 pt-4 lg:pt-6">
  <div class="absolute top-0 left-1/4 h-96 w-96 rounded-full bg-indigo-500/20 blur-3xl filter"></div>
  <div class="absolute bottom-0 right-1/4 h-96 w-96 rounded-full bg-violet-500/10 blur-3xl filter"></div>
  <div class="relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex flex-col items-center text-center">
      <div class="mb-8 inline-flex items-center rounded-full border border-indigo-400/30 bg-indigo-900/30 px-4 py-1.5 backdrop-blur-md shadow-glow">
        <span class="mr-2 flex h-2 w-2 relative">
          <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
          <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
        </span>
        <span class="text-xs font-semibold text-indigo-100 tracking-wide uppercase">Premium Government Solution</span>
      </div>
      <h1 class="mb-8 max-w-5xl text-5xl font-bold tracking-tight text-white sm:text-6xl lg:text-7xl leading-[1.1]">
        계약 실무,<br class="hidden sm:block"/>
        <span class="text-gradient">이제 혼자 고민하지 마세요</span>
      </h1>
      <p class="mb-12 max-w-2xl text-lg text-slate-300 leading-relaxed font-light">
        헷갈리는 절차, 복잡한 법령도<br class="hidden sm:block"/>
        단계별로 쉽게 안내해 드립니다.
      </p>

      <!-- Search -->
      <div class="w-full max-w-3xl mb-16 relative z-10">
        <form action="<%= chatbot_search_path %>" method="get" data-turbo="false">
          <div class="search-glass relative flex items-center rounded-2xl overflow-hidden p-2 transition-all duration-300">
            <div class="flex h-14 w-14 items-center justify-center text-indigo-300 pl-2">
              <span class="material-symbols-outlined text-3xl">search</span>
            </div>
            <input name="q" class="h-14 w-full border-0 bg-transparent px-4 text-white placeholder:text-slate-400 focus:ring-0 text-lg" placeholder="무엇을 도와드릴까요? (예: 수의계약 한도, 물품구매 절차)" type="text"/>
            <button type="submit" class="hidden sm:flex h-12 items-center justify-center rounded-xl bg-indigo-600 px-8 text-base font-bold text-white transition-all hover:bg-indigo-500 shadow-lg shadow-indigo-600/30">
              검색
            </button>
          </div>
        </form>
        <div class="mt-8 flex flex-wrap justify-center gap-3">
          <% [
            ["gavel", "수의계약", "indigo"],
            ["shopping_bag", "물품구매", "emerald"],
            ["engineering", "공사계약", "amber"],
            ["design_services", "용역계약", "pink"]
          ].each do |icon, keyword, color| %>
            <%= link_to chatbot_search_path(q: keyword), class: "group inline-flex items-center gap-2 rounded-full bg-slate-800/50 px-4 py-2 text-sm font-medium text-slate-300 hover:bg-indigo-600/20 hover:text-white hover:border-indigo-500/50 transition-all backdrop-blur-sm border border-slate-700/50", data: { turbo: false } do %>
              <span class="material-symbols-outlined text-[16px] text-<%= color %>-400 group-hover:text-<%= color %>-300"><%= icon %></span> <%= keyword %>
            <% end %>
          <% end %>
        </div>
      </div>

      <!-- Stats -->
      <div class="grid w-full max-w-4xl grid-cols-1 gap-6 sm:grid-cols-3">
        <div class="group flex flex-col rounded-2xl bg-white/5 p-6 text-center backdrop-blur-md border border-white/5 hover:bg-white/10 hover:border-white/10 transition-all duration-300 cursor-default">
          <span class="text-4xl font-bold text-white mb-1 group-hover:scale-110 transition-transform duration-300"><%= tool_count %>+</span>
          <span class="text-sm font-medium text-indigo-200/70 uppercase tracking-wider">업무 자동화 도구</span>
        </div>
        <div class="group flex flex-col rounded-2xl bg-white/5 p-6 text-center backdrop-blur-md border border-white/5 hover:bg-white/10 hover:border-white/10 transition-all duration-300 cursor-default">
          <span class="text-4xl font-bold text-white mb-1 group-hover:scale-110 transition-transform duration-300">25+</span>
          <span class="text-sm font-medium text-indigo-200/70 uppercase tracking-wider">법령 가이드</span>
        </div>
        <div class="group flex flex-col rounded-2xl bg-white/5 p-6 text-center backdrop-blur-md border border-white/5 hover:bg-white/10 hover:border-white/10 transition-all duration-300 cursor-default">
          <span class="text-4xl font-bold text-white mb-1 group-hover:scale-110 transition-transform duration-300">23+</span>
          <span class="text-sm font-medium text-indigo-200/70 uppercase tracking-wider">실무 서식 템플릿</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Core Tools Section -->
<section class="bg-background-light py-24 relative">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="mb-12 flex items-end justify-between">
      <div>
        <h2 class="text-3xl font-bold text-slate-900 sm:text-4xl tracking-tight">핵심 실무 도구</h2>
        <p class="mt-3 text-lg text-slate-500">복잡한 업무를 클릭 몇 번으로 해결하는 프리미엄 툴킷</p>
      </div>
      <%= link_to tools_path, class: "hidden group items-center gap-1 text-sm font-bold text-indigo-600 hover:text-indigo-700 sm:flex transition-colors" do %>
        전체 도구 보기
        <span class="material-symbols-outlined text-lg group-hover:translate-x-1 transition-transform">arrow_forward</span>
      <% end %>
    </div>

    <!-- Main 3 Tools -->
    <div class="grid grid-cols-1 gap-8 lg:grid-cols-3 mb-12">
      <%= link_to contract_method_path, class: "group relative overflow-hidden rounded-3xl bg-white p-8 shadow-glass hover:shadow-glass-hover hover:-translate-y-2 transition-all duration-500 border border-slate-100" do %>
        <div class="absolute inset-0 bg-gradient-to-br from-indigo-50/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
        <div class="relative z-10 mb-6 inline-flex h-14 w-14 items-center justify-center rounded-2xl bg-indigo-50 text-indigo-600 shadow-sm group-hover:bg-indigo-600 group-hover:text-white transition-colors duration-300">
          <span class="material-symbols-outlined text-3xl">account_tree</span>
        </div>
        <h3 class="relative z-10 text-2xl font-bold text-slate-900 mb-3">계약방식 결정</h3>
        <p class="relative z-10 text-slate-500 leading-relaxed mb-8">예산과 품목만 입력하면 법령에 맞는 최적의 계약 방식을 인공지능이 추천해 드립니다.</p>
        <div class="relative z-10 flex items-center text-indigo-600 font-bold group-hover:translate-x-2 transition-transform duration-300">
          <span>지금 확인하기</span>
          <span class="material-symbols-outlined ml-2 text-lg">arrow_forward</span>
        </div>
      <% end %>

      <%= link_to contract_documents_path, class: "group relative overflow-hidden rounded-3xl bg-white p-8 shadow-glass hover:shadow-glass-hover hover:-translate-y-2 transition-all duration-500 border border-slate-100" do %>
        <div class="absolute inset-0 bg-gradient-to-br from-violet-50/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
        <div class="relative z-10 mb-6 inline-flex h-14 w-14 items-center justify-center rounded-2xl bg-violet-50 text-violet-600 shadow-sm group-hover:bg-violet-600 group-hover:text-white transition-colors duration-300">
          <span class="material-symbols-outlined text-3xl">post_add</span>
        </div>
        <h3 class="relative z-10 text-2xl font-bold text-slate-900 mb-3">서류 원클릭 생성</h3>
        <p class="relative z-10 text-slate-500 leading-relaxed mb-8">계약 정보 입력 한 번으로 내부결재부터 계약서까지 모든 필수 서류를 자동 생성합니다.</p>
        <div class="relative z-10 flex items-center text-violet-600 font-bold group-hover:translate-x-2 transition-transform duration-300">
          <span>지금 확인하기</span>
          <span class="material-symbols-outlined ml-2 text-lg">arrow_forward</span>
        </div>
      <% end %>

      <%= link_to budget_estimator_path, class: "group relative overflow-hidden rounded-3xl bg-white p-8 shadow-glass hover:shadow-glass-hover hover:-translate-y-2 transition-all duration-500 border border-slate-100" do %>
        <div class="absolute inset-0 bg-gradient-to-br from-emerald-50/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
        <div class="relative z-10 mb-6 inline-flex h-14 w-14 items-center justify-center rounded-2xl bg-emerald-50 text-emerald-600 shadow-sm group-hover:bg-emerald-600 group-hover:text-white transition-colors duration-300">
          <span class="material-symbols-outlined text-3xl">calculate</span>
        </div>
        <h3 class="relative z-10 text-2xl font-bold text-slate-900 mb-3">소요예산 추정기</h3>
        <p class="relative z-10 text-slate-500 leading-relaxed mb-8">복잡한 원가계산 없이 빅데이터 기반으로 적정 예산을 빠르고 정확하게 추정하세요.</p>
        <div class="relative z-10 flex items-center text-emerald-600 font-bold group-hover:translate-x-2 transition-transform duration-300">
          <span>지금 확인하기</span>
          <span class="material-symbols-outlined ml-2 text-lg">arrow_forward</span>
        </div>
      <% end %>
    </div>

    <!-- Minor Tools -->
    <div class="grid grid-cols-2 gap-6 md:grid-cols-4">
      <% [
        [pdf_tools_path, "calendar_month", "계약기간 산정"],
        [travel_calculator_path, "percent", "지연배상금 계산"],
        [pre_contract_checklist_path, "checklist_rtl", "사전 체크리스트"],
        [contract_flow_path, "account_tree", "계약 흐름도"]
      ].each do |path, icon, label| %>
        <%= link_to path, class: "flex flex-col items-center justify-center gap-3 rounded-2xl bg-white p-6 shadow-sm border border-slate-100 hover:border-indigo-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300" do %>
          <div class="flex h-10 w-10 items-center justify-center rounded-full bg-slate-50 text-slate-600">
            <span class="material-symbols-outlined text-[20px]"><%= icon %></span>
          </div>
          <span class="text-sm font-semibold text-slate-900"><%= label %></span>
        <% end %>
      <% end %>
    </div>
  </div>
</section>

<!-- Quick Price Finder -->
<div class="bg-white py-20 border-y border-slate-100">
  <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
    <div class="relative rounded-3xl overflow-hidden bg-slate-900 shadow-2xl">
      <div class="absolute top-0 right-0 -mt-20 -mr-20 h-64 w-64 rounded-full bg-indigo-500 opacity-20 blur-3xl"></div>
      <div class="absolute bottom-0 left-0 -mb-20 -ml-20 h-64 w-64 rounded-full bg-emerald-500 opacity-20 blur-3xl"></div>
      <div class="relative z-10 p-8 md:p-12 flex flex-col lg:flex-row items-center justify-between gap-10">
        <div class="flex-1 text-center lg:text-left">
          <div class="inline-flex items-center gap-2 mb-4 px-3 py-1 rounded-full bg-white/10 border border-white/10 backdrop-blur-sm">
            <span class="material-symbols-outlined text-emerald-400 text-sm">payments</span>
            <span class="text-xs font-bold uppercase tracking-wider text-emerald-400">Smart Price Guide</span>
          </div>
          <h3 class="text-3xl font-bold text-white mb-3">예산을 입력해보세요</h3>
          <p class="text-slate-300 text-lg">금액에 따라 법령상 가능한 모든 계약 방법(1인 견적, 2인 이상 견적, 입찰 등)을<br class="hidden lg:block"/> 즉시 분석하여 가이드해드립니다.</p>
        </div>
        <div class="w-full lg:w-auto flex-1 max-w-lg">
          <div class="flex gap-3 mb-3">
            <select id="price-category" class="flex-shrink-0 w-24 rounded-xl border-0 bg-white/10 backdrop-blur-md text-white px-3 py-4 text-sm font-medium focus:ring-indigo-500">
              <option value="goods" class="text-slate-900">물품</option>
              <option value="service" class="text-slate-900">용역</option>
              <option value="construction" class="text-slate-900">공사</option>
            </select>
            <div class="flex-1 bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center shadow-lg">
              <input id="price-input" class="w-full bg-transparent border-0 px-4 py-2 text-2xl font-bold text-white placeholder:text-slate-500 focus:ring-0" placeholder="예: 22,000,000" type="text"/>
              <span class="text-slate-400 text-lg font-medium mr-4">원</span>
              <button type="button" onclick="document.getElementById('price-input').dispatchEvent(new Event('input'))" class="shrink-0 rounded-xl bg-indigo-600 px-8 py-4 text-base font-bold text-white shadow-lg shadow-indigo-600/30 hover:bg-indigo-500 transition-all">
                조회하기
              </button>
            </div>
          </div>
          <div class="flex flex-wrap gap-2 mb-4 justify-center lg:justify-start">
            <% [["1천만원", 10_000_000], ["2천만원", 20_000_000], ["5천만원", 50_000_000], ["1억원", 100_000_000], ["2억원", 200_000_000]].each do |label, val| %>
              <button type="button" class="price-quick-btn px-3 py-1.5 text-xs font-medium bg-white/5 text-slate-400 rounded-lg border border-white/10 hover:bg-indigo-600/20 hover:text-white hover:border-indigo-500/50 transition-all" data-value="<%= val %>"><%= label %></button>
            <% end %>
          </div>
          <p class="text-center lg:text-right text-xs text-slate-500">* 부가세 포함 금액 기준</p>
          <div id="price-result" class="hidden mt-4">
            <div id="price-result-content" class="p-4 rounded-xl border-2"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Topic Guides & Templates -->
<section class="py-24 bg-background-light">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-12 lg:gap-16">
      <!-- Topic Guides -->
      <div class="lg:col-span-7">
        <h2 class="mb-8 text-2xl font-bold text-slate-900 flex items-center gap-2">
          <span class="material-symbols-outlined text-indigo-600">library_books</span> 주요 법령 가이드
        </h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
          <% [
            ["/topics/private-contract", "handshake", "수의계약", "1인 견적 가능 금액 및 요건, 예외 사항 완벽 정리", "indigo"],
            ["/topics/emergency-contract", "warning", "긴급계약", "재해/재난 시 신속 대응을 위한 긴급 입찰 절차", "rose"],
            ["/topics/budget-carryover", "history", "예산이월", "사고이월 및 명시이월 처리를 위한 연말 필수 체크리스트", "emerald"]
          ].each do |path, icon, title, desc, color| %>
            <%= link_to path, class: "group flex items-start gap-4 rounded-2xl bg-white p-6 shadow-sm border border-slate-100 transition-all hover:shadow-lg hover:-translate-y-1 hover:border-indigo-100 cursor-pointer" do %>
              <div class="shrink-0 flex h-12 w-12 items-center justify-center rounded-xl bg-<%= color %>-50 text-<%= color %>-600 group-hover:bg-<%= color %>-600 group-hover:text-white transition-colors">
                <span class="material-symbols-outlined"><%= icon %></span>
              </div>
              <div>
                <h3 class="font-bold text-lg text-slate-900 group-hover:text-<%= color %>-600 transition-colors"><%= title %></h3>
                <p class="mt-1 text-sm text-slate-500 leading-snug"><%= desc %></p>
              </div>
            <% end %>
          <% end %>
        </div>
        <div class="mt-6">
          <%= link_to guides_path, class: "inline-flex items-center gap-1 text-sm font-bold text-indigo-600 hover:text-indigo-700 transition-colors" do %>
            모든 가이드 보기 <span class="material-symbols-outlined text-lg">arrow_forward</span>
          <% end %>
        </div>
      </div>

      <!-- Templates -->
      <div class="lg:col-span-5">
        <div class="flex items-center justify-between mb-8">
          <h2 class="text-2xl font-bold text-slate-900 flex items-center gap-2">
            <span class="material-symbols-outlined text-indigo-600">folder_open</span> 인기 서식
          </h2>
          <%= link_to templates_path, class: "text-sm font-semibold text-slate-500 hover:text-indigo-600 transition-colors" do %>
            더보기 →
          <% end %>
        </div>
        <div class="space-y-4">
          <% [
            { title: "물품 표준 구매계약서", format: "HWP", color: "indigo" },
            { title: "수의계약 배제사유 각서", format: "HWP", color: "indigo" },
            { title: "착수계 및 완료계 세트", format: "XLSX", color: "emerald" }
          ].each do |tmpl| %>
            <%= link_to templates_path, class: "flex items-center p-4 rounded-2xl bg-white border border-slate-100 shadow-sm hover:shadow-md hover:border-indigo-100 transition-all group" do %>
              <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-<%= tmpl[:color] %>-50 text-<%= tmpl[:color] %>-600 font-bold text-xs"><%= tmpl[:format] %></div>
              <div class="ml-4 flex-1">
                <h4 class="font-bold text-slate-900 group-hover:text-<%= tmpl[:color] %>-600 transition-colors"><%= tmpl[:title] %></h4>
                <span class="text-xs text-slate-500">최신 개정판</span>
              </div>
              <span class="material-symbols-outlined text-slate-300 group-hover:text-<%= tmpl[:color] %>-600 transition-colors">download</span>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Daily Quiz Section -->
<section class="relative overflow-hidden py-24 bg-[#0B1120]">
  <div class="absolute inset-0 bg-gradient-to-r from-slate-900 to-indigo-950/40"></div>
  <div class="absolute right-0 top-0 h-[500px] w-[500px] bg-indigo-600/10 blur-[100px] rounded-full pointer-events-none"></div>
  <div class="relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex flex-col md:flex-row items-center justify-between gap-16">
      <div class="max-w-xl text-white">
        <div class="mb-6 inline-flex items-center rounded-full bg-indigo-500/20 px-4 py-1.5 text-sm font-semibold text-indigo-300 ring-1 ring-inset ring-indigo-500/30">
          <span class="mr-2 h-1.5 w-1.5 rounded-full bg-indigo-400 animate-pulse"></span>
          오늘의 실무 퀴즈
        </div>
        <h2 class="text-4xl font-bold tracking-tight sm:text-5xl leading-tight">매일 하나씩,<br/><span class="text-indigo-400">계약 전문가</span>로 성장하세요.</h2>
        <p class="mt-6 text-xl text-slate-400 font-light leading-relaxed">하루 1분 투자로 헷갈리는 법령과 지침을 마스터할 수 있습니다.<br/>틀려도 괜찮아요, 명쾌한 해설이 있으니까요.</p>
      </div>
      <div class="w-full max-w-md">
        <div class="glass-dark rounded-3xl p-8 shadow-2xl relative border-t border-white/10">
          <div class="absolute -top-3 -right-3 h-20 w-20 bg-emerald-500/20 blur-2xl rounded-full"></div>
          <div class="mb-8 flex items-center justify-between">
            <span id="quiz-progress" class="text-xs font-bold tracking-widest text-slate-400 uppercase">문제 1/5</span>
            <span id="quiz-category" class="inline-flex items-center rounded-md bg-emerald-400/10 px-2 py-1 text-xs font-bold text-emerald-400 ring-1 ring-inset ring-emerald-400/20">예산회계</span>
          </div>
          <h3 id="quiz-question" class="mb-10 text-xl font-bold text-white leading-relaxed"></h3>
          <div class="space-y-3" id="quiz-options"></div>
          <div id="quiz-result" class="hidden mt-4 p-4 rounded-xl">
            <p class="font-semibold text-lg" id="result-message"></p>
            <p class="text-sm mt-2 text-gray-300" id="result-explanation"></p>
          </div>
          <div id="quiz-final" class="hidden text-center py-6">
            <div class="text-5xl mb-3">&#127881;</div>
            <h3 class="text-xl font-bold text-white mb-2">퀴즈 완료!</h3>
            <p class="text-gray-300 mb-2">총 5문제 중 <span id="final-score" class="text-emerald-400 font-bold">0</span>문제 정답</p>
            <button id="quiz-restart" class="mt-3 px-6 py-2.5 rounded-lg bg-indigo-600 text-white font-bold hover:bg-indigo-500 transition-colors">다시 도전하기</button>
          </div>
          <div id="quiz-footer" class="mt-6 flex justify-end">
            <button id="quiz-submit" class="px-6 py-2.5 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-500 shadow-lg shadow-indigo-600/30 transition-all disabled:opacity-40 disabled:cursor-not-allowed" disabled>정답 확인</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- External Links / Partner Networks -->
<section class="bg-slate-50 py-20 border-t border-slate-200">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <h2 class="mb-10 text-center text-lg font-bold text-slate-400 uppercase tracking-widest">Partner Networks</h2>
    <div class="grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-6">
      <% [
        ["https://www.g2b.go.kr", "G2B", "나라장터", "text-blue-900"],
        ["https://www.s2b.kr", "S2B", "학교장터", "text-orange-500"],
        ["https://www.onbid.co.kr", "On-Bid", "온비드", "text-green-600"],
        ["https://www.lofin365.go.kr", "e-Hozo", "지방재정", "text-slate-800"],
        ["https://eduinfo.go.kr", "EDUI", "지방교육재정", "text-indigo-600"],
        ["https://www.law.go.kr", "Law", "국가법령센터", "text-violet-600"]
      ].each do |url, abbr, name, color_class| %>
        <a href="<%= url %>" target="_blank" rel="noopener" class="group flex flex-col items-center justify-center rounded-2xl bg-white p-6 shadow-sm border border-slate-100 transition-all hover:-translate-y-1 hover:shadow-md hover:border-indigo-100">
          <span class="mb-2 text-xl font-black <%= color_class %> group-hover:scale-105 transition-transform"><%= abbr %></span>
          <span class="text-xs font-medium text-slate-500"><%= name %></span>
        </a>
      <% end %>
    </div>
  </div>
</section>

<!-- Final CTA -->
<section class="bg-white py-24">
  <div class="mx-auto max-w-4xl px-4 text-center sm:px-6 lg:px-8">
    <h2 class="text-4xl font-bold tracking-tight text-slate-900 sm:text-5xl">
      실무, 이제 더 쉽고 완벽하게.
    </h2>
    <p class="mx-auto mt-6 max-w-2xl text-xl text-slate-500 font-light">
      공무원이 선택한 프리미엄 실무 플랫폼, 지금 바로 시작해보세요.
    </p>
    <div class="mt-10 flex flex-col sm:flex-row justify-center gap-4">
      <%= link_to new_user_registration_path, class: "rounded-xl bg-slate-900 px-8 py-4 text-base font-bold text-white shadow-xl shadow-slate-900/10 hover:bg-slate-800 hover:scale-105 transition-all" do %>
        지금 바로 시작하기
      <% end %>
      <%= link_to tools_path, class: "rounded-xl bg-slate-100 px-8 py-4 text-base font-bold text-slate-700 hover:bg-slate-200 transition-all" do %>
        실무 도구 둘러보기
      <% end %>
    </div>
  </div>
</section>

</div>

<!-- 금액 계산기 -->
<script>
document.addEventListener('turbo:load', function() {
  const priceInput = document.getElementById('price-input');
  const priceCategory = document.getElementById('price-category');
  const priceResult = document.getElementById('price-result');
  const priceResultContent = document.getElementById('price-result-content');
  if (!priceInput) return;

  priceInput.addEventListener('input', function() {
    let val = this.value.replace(/[^0-9]/g, '');
    if (val) { this.value = Number(val).toLocaleString(); calculateMethod(); }
    else { this.value = ''; priceResult.classList.add('hidden'); }
  });

  document.querySelectorAll('.price-quick-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      priceInput.value = Number(this.dataset.value).toLocaleString();
      calculateMethod();
    });
  });

  function calculateMethod() {
    const amount = parseInt(priceInput.value.replace(/,/g, ''));
    const category = priceCategory.value;
    if (!amount || amount <= 0) { priceResult.classList.add('hidden'); return; }
    let method, color, icon, desc, checklist;
    if (category === 'construction') {
      if (amount <= 20000000) { method='1인 견적 수의계약'; color='emerald'; icon='person'; desc='추정가격 2천만원 이하 공사'; checklist=['견적서 1부 징구','계약서 작성 (간이계약서 가능)','착공신고서','준공검사 및 대가 지급']; }
      else if (amount <= 200000000) { method='2인 이상 견적 수의계약'; color='indigo'; icon='group'; desc='추정가격 2천만원 초과 ~ 2억원 이하 공사'; checklist=['추정가격 산정','2인 이상 견적서 징구','예정가격 작성','계약서 작성','착공신고서 → 준공검사 → 대가 지급']; }
      else { method='경쟁입찰'; color='slate'; icon='groups'; desc='추정가격 2억원 초과 공사'; checklist=['추정가격 산정','입찰공고 (7일 이상)','예정가격 작성 (복수예비가격)','적격심사','계약 체결 → 착공 → 준공검사']; }
    } else {
      if (amount <= 20000000) { method='1인 견적 수의계약'; color='emerald'; icon='person'; desc=`추정가격 2천만원 이하 ${category==='goods'?'물품':'용역'}`; checklist=['견적서 1부 징구','계약서 작성 (간이계약서 가능)','검수 및 대가 지급']; }
      else if (amount <= 100000000) { method='2인 이상 견적 수의계약'; color='indigo'; icon='group'; desc=`추정가격 2천만원 초과 ~ 1억원 이하 ${category==='goods'?'물품':'용역'}`; checklist=['추정가격 산정','2인 이상 견적서 징구','예정가격 작성','계약서 작성','검수 및 대가 지급']; }
      else { method='경쟁입찰'; color='slate'; icon='groups'; desc=`추정가격 1억원 초과 ${category==='goods'?'물품':'용역'}`; checklist=['추정가격 산정','입찰공고 (7일 이상)','예정가격 작성 (복수예비가격)','적격심사 또는 최저가낙찰','계약 체결 → 검수 → 대가 지급']; }
    }
    priceResult.classList.remove('hidden');
    priceResultContent.className = `p-4 rounded-xl border border-white/10 bg-white/5 backdrop-blur-sm`;
    priceResultContent.innerHTML = `
      <div class="flex items-center gap-3 mb-3">
        <span class="material-symbols-outlined text-2xl text-${color}-400">${icon}</span>
        <h3 class="text-lg font-bold text-white">${method}</h3>
      </div>
      <p class="text-slate-400 text-sm mb-3">${desc} (추정가격: ${Number(amount).toLocaleString()}원)</p>
      <div class="space-y-2">
        ${checklist.map(item => `<div class="flex items-start gap-2"><span class="material-symbols-outlined text-${color}-400 text-lg mt-0.5">check_circle</span><span class="text-slate-300 text-sm">${item}</span></div>`).join('')}
      </div>
      <div class="mt-4 pt-3 border-t border-white/10">
        <a href="${'<%= contract_method_path %>'}" class="inline-flex items-center gap-1 text-indigo-400 hover:text-indigo-300 text-sm font-semibold">상세 분석 바로가기 <span class="material-symbols-outlined text-lg">arrow_forward</span></a>
      </div>`;
  }
  priceCategory.addEventListener('change', function() { if (priceInput.value) calculateMethod(); });
});
</script>

<!-- 퀴즈 -->
<script>
document.addEventListener('turbo:load', function() {
  const allQuizData = [
    { category: "예산회계", question: "다음 중 예산의 이월에 해당하지 않는 것은?", options: ["명시이월", "사고이월", "계속비이월", "예비비이월"], answer: 3, explanation: "예비비이월은 존재하지 않는 개념입니다." },
    { category: "예산회계", question: "다음 중 세출예산의 이용에 해당하는 것은?", options: ["장 간의 상호융통", "관 간의 상호융통", "항 간의 상호융통", "세항 간의 상호융통"], answer: 2, explanation: "이용은 입법과목인 '항' 간의 상호융통을 말합니다." },
    { category: "예산회계", question: "예비비 사용 후 국회 승인을 받아야 하는 기한은?", options: ["다음 연도 정기회 개회 전", "다음 연도 정기회 중", "사용 후 3개월 이내", "사용 후 6개월 이내"], answer: 1, explanation: "예비비 사용 후 다음 연도 정기회 중에 국회의 승인을 받아야 합니다." },
    { category: "예산회계", question: "사고이월의 요건이 아닌 것은?", options: ["연도 내 지출원인행위", "불가피한 사유", "세입세출예산에 명시", "연도 내 지출하지 못한 경비"], answer: 2, explanation: "세입세출예산에 명시하는 것은 명시이월의 요건입니다." },
    { category: "예산회계", question: "예산의 전용이란?", options: ["회계연도 간 이월", "항 간의 상호융통", "세항·목 간의 상호융통", "예비비 사용"], answer: 2, explanation: "전용은 행정과목인 세항·목 간의 상호융통을 말합니다." },
    { category: "계약", question: "물품 구매 시 1인 견적 수의계약이 가능한 추정가격(부가세 별도) 기준은?", options: ["1천만원 이하", "2천만원 이하", "3천만원 이하", "5천만원 이하"], answer: 1, explanation: "물품·용역의 경우 추정가격 2천만원 이하일 때 1인 견적 수의계약이 가능합니다." },
    { category: "계약", question: "나라장터 전자입찰 시 입찰공고 기간은 최소 며칠인가?", options: ["5일", "7일", "10일", "14일"], answer: 1, explanation: "전자입찰의 경우 입찰공고 기간은 최소 7일 이상입니다." },
    { category: "계약", question: "계약보증금의 원칙적인 비율은?", options: ["계약금액의 5%", "계약금액의 10%", "계약금액의 15%", "계약금액의 20%"], answer: 1, explanation: "계약보증금은 계약금액의 10% 이상으로 납부해야 합니다." },
    { category: "계약", question: "선금의 지급 한도는?", options: ["계약금액의 50%", "계약금액의 60%", "계약금액의 70%", "계약금액의 80%"], answer: 2, explanation: "선금은 계약금액의 70% 이내에서 지급할 수 있습니다." },
    { category: "계약", question: "복수예비가격 작성 개수는?", options: ["10개", "15개", "20개", "25개"], answer: 1, explanation: "복수예비가격은 15개를 작성합니다." },
    { category: "복무", question: "공무원의 병가 일수는 연간 최대 며칠인가?", options: ["30일", "60일", "90일", "120일"], answer: 1, explanation: "공무원의 병가는 연 60일 이내입니다." },
    { category: "복무", question: "재직기간 1년 미만 공무원의 연가 일수는?", options: ["8일", "11일", "14일", "15일"], answer: 1, explanation: "재직기간 1년 미만 공무원의 연가 일수는 11일입니다." },
    { category: "복무", question: "배우자 출산휴가 일수는?", options: ["5일", "10일", "15일", "20일"], answer: 3, explanation: "배우자 출산휴가는 20일입니다. (2025년 공무원복무규정 개정)" },
    { category: "문서", question: "공문서의 보존기간 중 '영구'에 해당하는 것은?", options: ["일반 통계자료", "조례·규칙", "단순 민원서류", "일일업무보고"], answer: 1, explanation: "조례, 규칙 등 법규문서는 영구 보존 대상입니다." },
    { category: "민원", question: "정보공개 청구에 대한 결정 기한은?", options: ["5일 이내", "7일 이내", "10일 이내", "14일 이내"], answer: 2, explanation: "정보공개 청구를 받은 날부터 10일 이내에 공개 여부를 결정해야 합니다." },
    { category: "감사", question: "일상감사 대상이 아닌 것은?", options: ["계약", "예산 전용", "국고보조금 교부", "일반 민원처리"], answer: 3, explanation: "일반 민원처리는 일상감사 대상이 아닙니다." },
    { category: "인사", question: "5급 공무원의 정년은?", options: ["58세", "60세", "62세", "65세"], answer: 1, explanation: "일반직 공무원의 정년은 60세입니다." },
    { category: "계약", question: "지체상금률의 상한은?", options: ["계약금액의 10%", "계약금액의 15%", "계약금액의 20%", "계약금액의 30%"], answer: 0, explanation: "지체상금은 계약금액의 10%를 초과할 수 없습니다." },
    { category: "예산회계", question: "지방자치단체의 출납폐쇄일은?", options: ["12월 31일", "다음 연도 1월 31일", "다음 연도 2월 말일", "다음 연도 3월 31일"], answer: 2, explanation: "지방자치단체의 출납폐쇄일은 다음 연도 2월 말일입니다." },
    { category: "복무", question: "시간외근무수당 지급 단가 산정 시 사용하는 분모는?", options: ["174시간", "209시간", "226시간", "243시간"], answer: 1, explanation: "시간외근무수당은 월 봉급액을 209시간으로 나눈 금액을 기준으로 산정합니다." }
  ];

  function getDailyQuiz() {
    const today = new Date();
    const seed = today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
    const shuffled = [...allQuizData];
    for (let i = shuffled.length - 1; i > 0; i--) {
      const j = Math.floor((seed * (i + 1) * 9301 + 49297) % 233280 / 233280 * (i + 1));
      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled.slice(0, 5);
  }

  const quizData = getDailyQuiz();
  let currentQuestion = 0, score = 0, selectedOption = null, answered = false;
  const progressEl = document.getElementById('quiz-progress');
  if (!progressEl) return;
  const categoryEl = document.getElementById('quiz-category');
  const questionEl = document.getElementById('quiz-question');
  const optionsEl = document.getElementById('quiz-options');
  const resultDiv = document.getElementById('quiz-result');
  const resultMessage = document.getElementById('result-message');
  const resultExplanation = document.getElementById('result-explanation');
  const submitBtn = document.getElementById('quiz-submit');
  const finalDiv = document.getElementById('quiz-final');
  const finalScore = document.getElementById('final-score');
  const footerDiv = document.getElementById('quiz-footer');
  const restartBtn = document.getElementById('quiz-restart');

  function renderQuestion() {
    const q = quizData[currentQuestion];
    progressEl.textContent = `문제 ${currentQuestion + 1}/5`;
    categoryEl.textContent = q.category;
    questionEl.textContent = q.question;
    optionsEl.innerHTML = q.options.map((opt, i) => `
      <button data-index="${i}" class="quiz-option w-full text-left p-4 rounded-xl bg-slate-800/50 hover:bg-slate-700/50 border border-white/5 text-slate-200 text-sm transition-all cursor-pointer flex items-center gap-3">
        <span class="w-7 h-7 rounded-full border border-white/20 flex items-center justify-center text-xs font-medium shrink-0">${String.fromCharCode(65+i)}</span>
        <span>${opt}</span>
      </button>
    `).join('');
    document.querySelectorAll('.quiz-option').forEach(o => o.addEventListener('click', handleOptionClick));
    selectedOption = null; answered = false;
    resultDiv.classList.add('hidden');
    resultDiv.classList.remove('bg-emerald-500/20','bg-red-500/20');
    resultMessage.classList.remove('text-emerald-300','text-red-300');
    submitBtn.disabled = true;
    submitBtn.textContent = '정답 확인';
  }

  function handleOptionClick() {
    if (answered) return;
    document.querySelectorAll('.quiz-option').forEach(o => { o.classList.remove('bg-indigo-600/30','border-indigo-400'); o.classList.add('bg-slate-800/50','border-white/5'); });
    this.classList.remove('bg-slate-800/50','border-white/5');
    this.classList.add('bg-indigo-600/30','border-indigo-400');
    selectedOption = this;
    submitBtn.disabled = false;
  }

  function handleSubmit() {
    if (!selectedOption) return;
    if (!answered) {
      answered = true;
      const q = quizData[currentQuestion];
      const si = parseInt(selectedOption.dataset.index);
      const correct = si === q.answer;
      if (correct) score++;
      document.querySelectorAll('.quiz-option').forEach(o => {
        o.classList.add('cursor-not-allowed');
        const idx = parseInt(o.dataset.index);
        if (idx === q.answer) { o.classList.remove('bg-slate-800/50','bg-indigo-600/30'); o.classList.add('bg-emerald-600/30','border-emerald-400'); }
        else if (o === selectedOption && !correct) { o.classList.remove('bg-indigo-600/30'); o.classList.add('bg-red-500/30','border-red-400'); }
      });
      resultDiv.classList.remove('hidden');
      if (correct) { resultDiv.classList.add('bg-emerald-500/20'); resultMessage.textContent = '정답입니다!'; resultMessage.classList.add('text-emerald-300'); }
      else { resultDiv.classList.add('bg-red-500/20'); resultMessage.textContent = '오답입니다.'; resultMessage.classList.add('text-red-300'); }
      resultExplanation.textContent = q.explanation;
      submitBtn.textContent = currentQuestion < quizData.length - 1 ? '다음 문제 →' : '결과 보기';
    } else {
      if (currentQuestion < quizData.length - 1) { currentQuestion++; renderQuestion(); }
      else { questionEl.classList.add('hidden'); optionsEl.classList.add('hidden'); resultDiv.classList.add('hidden'); footerDiv.classList.add('hidden'); finalDiv.classList.remove('hidden'); finalScore.textContent = score; }
    }
  }

  submitBtn.addEventListener('click', handleSubmit);
  restartBtn.addEventListener('click', function() {
    currentQuestion = 0; score = 0;
    questionEl.classList.remove('hidden'); optionsEl.classList.remove('hidden');
    footerDiv.classList.remove('hidden'); finalDiv.classList.add('hidden');
    renderQuestion();
  });
  renderQuestion();
});
</script>
