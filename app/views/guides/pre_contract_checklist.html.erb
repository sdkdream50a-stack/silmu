<%# 계약업무 사전 체크리스트 - 서울시교육청 스타일 참고 %>

<style>
  .checklist-page {
    max-width: 1200px;
    margin: 0 auto;
  }

  /* 탭 네비게이션 */
  .checklist-tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 32px;
    padding: 6px;
    background: var(--color-surface-100);
    border-radius: 16px;
    overflow-x: auto;
  }
  .checklist-tab {
    flex: 1;
    min-width: 100px;
    padding: 14px 20px;
    border: none;
    border-radius: 12px;
    background: transparent;
    font-size: 15px;
    font-weight: 600;
    color: var(--color-slate-600);
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }
  .checklist-tab:hover {
    background: white;
  }
  .checklist-tab.active {
    background: white;
    color: var(--color-slate-900);
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  }
  .checklist-tab .material-symbols-outlined {
    font-size: 22px;
  }

  /* 체크리스트 컨테이너 */
  .checklist-container {
    display: none;
  }
  .checklist-container.active {
    display: block;
    animation: fadeIn 0.3s ease;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* 단계 카드 */
  .check-stage {
    background: white;
    border-radius: 16px;
    margin-bottom: 20px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.04);
    border: 1px solid #e2e8f0;
    overflow: hidden;
  }
  .stage-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px 24px;
    background: linear-gradient(135deg, var(--color-surface-50), white);
    border-bottom: 1px solid #e2e8f0;
    cursor: pointer;
    transition: background 0.2s;
  }
  .stage-header:hover {
    background: var(--color-surface-100);
  }
  .stage-header .left {
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .stage-number {
    width: 36px;
    height: 36px;
    border-radius: 10px;
    background: var(--color-slate-700);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 16px;
  }
  .stage-info h3 {
    font-size: 17px;
    font-weight: 700;
    color: var(--color-slate-900);
    margin-bottom: 4px;
  }
  .stage-info .sub {
    font-size: 13px;
    color: #64748b;
  }
  .stage-progress {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .progress-bar {
    width: 100px;
    height: 6px;
    background: var(--color-surface-200);
    border-radius: 3px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    background: var(--color-emerald-500);
    border-radius: 3px;
    transition: width 0.3s ease;
  }
  .progress-text {
    font-size: 13px;
    font-weight: 600;
    color: var(--color-emerald-600);
  }
  .toggle-icon {
    color: var(--color-slate-400);
    transition: transform 0.2s;
  }
  .stage-header.open .toggle-icon {
    transform: rotate(180deg);
  }

  /* 체크 항목 */
  .stage-body {
    padding: 0;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease, padding 0.3s ease;
  }
  .stage-body.open {
    padding: 20px 24px;
    max-height: 2000px;
  }

  .check-item {
    display: flex;
    align-items: flex-start;
    gap: 16px;
    padding: 20px;
    background: var(--color-surface-50);
    border-radius: 14px;
    margin-bottom: 12px;
    border: 2px solid transparent;
    transition: all 0.2s;
    cursor: pointer;
  }
  .check-item:hover {
    background: white;
    border-color: var(--color-emerald-200);
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }
  .check-item.checked {
    background: var(--color-emerald-50);
    border-color: var(--color-emerald-400);
  }
  .check-item:last-child {
    margin-bottom: 0;
  }

  .check-box {
    width: 28px;
    height: 28px;
    border: 2px solid #cbd5e1;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.2s;
    margin-top: 2px;
  }
  .check-item.checked .check-box {
    background: var(--color-emerald-500);
    border-color: var(--color-emerald-500);
  }
  .check-box .material-symbols-outlined {
    font-size: 18px;
    color: white;
    opacity: 0;
    transition: opacity 0.2s;
  }
  .check-item.checked .check-box .material-symbols-outlined {
    opacity: 1;
  }

  .check-content {
    flex: 1;
  }
  .check-title {
    font-size: 15px;
    font-weight: 600;
    color: var(--color-slate-900);
    margin-bottom: 6px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .check-title .required {
    font-size: 10px;
    padding: 2px 6px;
    background: var(--color-amber-100);
    color: var(--color-amber-700);
    border-radius: 4px;
    font-weight: 600;
  }
  .check-desc {
    font-size: 13px;
    color: #64748b;
    line-height: 1.6;
    margin-bottom: 10px;
  }

  /* 법령 근거 */
  .legal-basis {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: var(--color-indigo-50);
    border-radius: 6px;
    font-size: 12px;
    color: var(--color-indigo-700);
    margin-right: 8px;
    margin-bottom: 6px;
  }
  .legal-basis .material-symbols-outlined {
    font-size: 14px;
  }

  /* 주의사항/팁 */
  .check-tips {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px dashed #e2e8f0;
  }
  .tip-item {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    font-size: 12px;
    color: var(--color-slate-600);
    margin-bottom: 6px;
  }
  .tip-item:last-child {
    margin-bottom: 0;
  }
  .tip-item.warning {
    color: var(--color-amber-700);
  }
  .tip-item .material-symbols-outlined {
    font-size: 16px;
    flex-shrink: 0;
  }

  /* 요약 카드 */
  .summary-card {
    background: white;
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.04);
    border: 1px solid #e2e8f0;
  }
  .summary-card h2 {
    font-size: 18px;
    font-weight: 700;
    color: var(--color-slate-900);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .summary-stats {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 16px;
  }
  .stat-item {
    text-align: center;
    padding: 16px;
    background: var(--color-surface-50);
    border-radius: 12px;
  }
  .stat-item .value {
    font-size: 28px;
    font-weight: 700;
    color: var(--color-slate-900);
    margin-bottom: 4px;
  }
  .stat-item .label {
    font-size: 13px;
    color: #64748b;
  }
  .stat-item.completed .value {
    color: var(--color-emerald-600);
  }
  .stat-item.pending .value {
    color: var(--color-amber-600);
  }

  /* 빠른 링크 */
  .quick-links {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid #e2e8f0;
  }
  .quick-link {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 16px;
    background: var(--color-surface-100);
    border-radius: 10px;
    color: var(--color-slate-700);
    text-decoration: none;
    font-size: 13px;
    font-weight: 500;
    transition: all 0.2s;
  }
  .quick-link:hover {
    background: var(--color-slate-100);
    color: var(--color-slate-900);
  }
  .quick-link .material-symbols-outlined {
    font-size: 18px;
  }

  /* 액션 버튼 */
  .action-buttons {
    display: flex;
    gap: 12px;
    margin-top: 24px;
  }
  .btn-action {
    padding: 14px 24px;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s;
    border: none;
  }
  .btn-action.primary {
    background: linear-gradient(135deg, var(--color-emerald-600), var(--color-emerald-500));
    color: white;
  }
  .btn-action.primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(47, 129, 50, 0.3);
  }
  .btn-action.secondary {
    background: var(--color-surface-100);
    color: var(--color-slate-700);
  }
  .btn-action.secondary:hover {
    background: var(--color-surface-200);
  }

  /* 반응형 */
  @media (max-width: 768px) {
    .checklist-tabs {
      flex-wrap: nowrap;
    }
    .checklist-tab span:not(.material-symbols-outlined) {
      display: none;
    }
    .summary-stats {
      grid-template-columns: repeat(2, 1fr);
    }
    .action-buttons {
      flex-direction: column;
    }
  }

  /* 인쇄 스타일 */
  @media print {
    .checklist-tabs, .action-buttons {
      display: none !important;
    }
    .stage-body {
      max-height: none !important;
      padding: 20px 24px !important;
    }
    .check-stage {
      page-break-inside: avoid;
    }
  }
</style>

<!-- 페이지 헤더 -->
<section class="gradient-slate text-white py-12 lg:py-16">
  <div class="container-wide">
    <div class="flex items-start gap-5">
      <div class="w-16 h-16 bg-white/10 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/20 shadow-lg">
        <span class="material-symbols-outlined text-4xl text-white">checklist_rtl</span>
      </div>
      <div>
        <h1 class="text-3xl lg:text-4xl font-bold tracking-tight mb-2">계약업무 사전 체크리스트</h1>
        <p class="text-slate-200 text-lg">계약 전 필수 확인사항을 단계별로 점검하세요</p>
      </div>
    </div>
  </div>
</section>

<section class="section py-10">
  <div class="container-wide checklist-page">
    <!-- 탭 네비게이션 -->
    <div class="checklist-tabs">
      <button class="checklist-tab active" data-tab="goods" onclick="showChecklist('goods')">
        <span class="material-symbols-outlined">inventory_2</span>
        <span>물품</span>
      </button>
      <button class="checklist-tab" data-tab="service" onclick="showChecklist('service')">
        <span class="material-symbols-outlined">support_agent</span>
        <span>용역</span>
      </button>
      <button class="checklist-tab" data-tab="construction" onclick="showChecklist('construction')">
        <span class="material-symbols-outlined">construction</span>
        <span>공사</span>
      </button>
    </div>

    <!-- 물품 체크리스트 -->
    <div class="checklist-container active" id="checklist-goods">
      <!-- 요약 -->
      <div class="summary-card">
        <h2>
          <span class="material-symbols-outlined" style="color: var(--color-emerald-500);">inventory_2</span>
          물품 계약 체크리스트
        </h2>
        <div class="summary-stats">
          <div class="stat-item">
            <div class="value" id="goods-total">12</div>
            <div class="label">전체 항목</div>
          </div>
          <div class="stat-item completed">
            <div class="value" id="goods-completed">0</div>
            <div class="label">완료</div>
          </div>
          <div class="stat-item pending">
            <div class="value" id="goods-pending">12</div>
            <div class="label">미완료</div>
          </div>
          <div class="stat-item">
            <div class="value" id="goods-percent">0%</div>
            <div class="label">진행률</div>
          </div>
        </div>
        <div class="quick-links">
          <%= link_to contract_method_path, class: "quick-link" do %>
            <span class="material-symbols-outlined">gavel</span>
            계약방식 결정
          <% end %>
          <%= link_to contract_documents_path, class: "quick-link" do %>
            <span class="material-symbols-outlined">description</span>
            서류 체크리스트
          <% end %>
          <a href="https://www.g2b.go.kr" target="_blank" class="quick-link">
            <span class="material-symbols-outlined">open_in_new</span>
            나라장터
          </a>
          <a href="https://www.smpp.go.kr" target="_blank" class="quick-link">
            <span class="material-symbols-outlined">open_in_new</span>
            중소기업제품 공공구매
          </a>
        </div>
      </div>

      <!-- 1단계: 기본계획 수립 -->
      <div class="check-stage" data-type="goods">
        <div class="stage-header open" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">1</div>
            <div class="stage-info">
              <h3>기본계획 수립</h3>
              <div class="sub">구매 목적, 수량, 규격서, 예산 확인</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/2</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body open">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                기본계획 수립 여부
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                물품 구매의 목적, 필요성, 규격, 수량, 예산 등 기본계획을 수립했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 제7조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  특정 업체에 유리한 규격 설정 금지
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  구매 목적에 맞는 최소한의 규격 설정
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                물품 규격서(Specification) 작성
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                구매할 물품의 필수 사양, 선택 사양, 수량 등을 구체적으로 명시한 규격서를 작성했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제14조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  규격서 없이 견적 요청 시 업체 간 비교 불가 및 감사 지적 위험
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  필수 사양과 선택 사양을 구분하여 기재
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 2단계: 예정가격 작성 -->
      <div class="check-stage" data-type="goods">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">2</div>
            <div class="stage-info">
              <h3>예정가격 작성</h3>
              <div class="sub">시장조사, 원가계산, 예정가격 결정</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/2</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                예정가격 작성 방법 확인
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                거래실례가격, 원가계산가격, 감정가격, 유사거래실례가격 등 적정한 방법으로 예정가격을 산정했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제7조~제9조
              </div>
              <div class="check-tips">
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  조달청 가격(나라장터 종합쇼핑몰) 우선 확인
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  추정가격 2천만원 이하 수의계약 시 예정가격 작성 생략 가능 (시행령 제9조)
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                2개 이상 가격 비교
              </div>
              <div class="check-desc">
                수의계약 시 2인 이상 견적 비교를 통해 예정가격을 결정했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제30조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  2,000만원 초과 시 2인 이상 견적 필수
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 3단계: 중소기업 제품 확인 -->
      <div class="check-stage" data-type="goods">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">3</div>
            <div class="stage-info">
              <h3>중소기업 제품 확인</h3>
              <div class="sub">중소기업 직접생산 확인, 경쟁제품 해당 여부</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/1</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                중소기업 경쟁제품 해당 여부
              </div>
              <div class="check-desc">
                구매예정 물품이 중소기업자간 경쟁제품에 해당하는지 확인합니다. 해당 시 중소기업자만 참여 가능합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                중소기업제품 구매촉진법 제6조
              </div>
              <div class="check-tips">
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  5천만원 초과 시 중소기업 경쟁제품 확인 필수
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  중소기업제품 공공구매 종합정보망(smpp.go.kr) 확인
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 4단계: 계약방법 결정 -->
      <div class="check-stage" data-type="goods">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">4</div>
            <div class="stage-info">
              <h3>계약방법 결정</h3>
              <div class="sub">입찰 또는 수의계약 방식 결정, 분할계약 검토</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/2</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                계약방법 결정
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                추정가격에 따른 적정 계약방법(입찰/수의계약)을 결정했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제25조, 제30조
              </div>
              <div class="check-tips">
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  물품: 2,000만원 이하 소액수의계약 가능
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  2천만원 초과 수의계약 시 G2B 전자견적 필수 (시행령 제39조)
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                분할계약(쪼개기) 사전 검토
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                동일 목적의 계약을 여러 건으로 분할하여 수의계약 범위에 맞추는 것은 아닌지 사전 검토합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제25조제6항
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  분할계약은 감사 지적의 가장 대표적인 사례 - 사전준비 단계에서 검토 필수
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  동일 시기, 동일 목적, 동일 장소의 계약은 합산하여 계약방법 결정
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 5단계: 청렴성 검증 -->
      <div class="check-stage" data-type="goods">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">5</div>
            <div class="stage-info">
              <h3>청렴성 검증</h3>
              <div class="sub">체결제한 확인, 부정당업자 조회, 청렴서약서</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/3</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                수의계약 체결 제한 여부 확인서 징구
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                계약상대자가 수의계약 배제사유(부정당업자 제재, 영업정지, 과징금 등)에 해당하는지 확인하고 확인서를 징구합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제25조, 제31조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  배제사유 미확인 시 계약 무효 및 감사 지적 대상
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  나라장터(G2B) 부정당업자 제재현황 조회 후 확인서 징구
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                부정당업자 제재현황 조회
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                계약상대자가 부정당업자 제재 중인지 나라장터(G2B)에서 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 제31조
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                청렴서약서 징구
              </div>
              <div class="check-desc">
                수의계약 시 청렴서약서(수의계약 통합서약서)를 징구합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행규칙 제42조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  동일 업체와 연속 3회 이상 수의계약 시 청렴성 문제 발생 가능
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 6단계: 계약 체결 -->
      <div class="check-stage" data-type="goods">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">6</div>
            <div class="stage-info">
              <h3>계약 체결</h3>
              <div class="sub">계약서 작성, 보증서 징구</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/2</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                계약서 작성 여부
              </div>
              <div class="check-desc">
                계약금액 3,000만원 이상 시 반드시 계약서를 작성해야 합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 제14조, 시행령 제49조
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                계약보증금 확인
              </div>
              <div class="check-desc">
                계약금액의 10% 이상 계약보증금 납부 여부를 확인합니다. (5,000만원 이하 면제 가능)
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제51조
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="action-buttons">
        <button class="btn-action primary" onclick="window.print()">
          <span class="material-symbols-outlined">print</span>
          체크리스트 인쇄
        </button>
        <button class="btn-action secondary" onclick="resetChecklist('goods')">
          <span class="material-symbols-outlined">refresh</span>
          초기화
        </button>
        <%= link_to contract_documents_path, class: "btn-action secondary" do %>
          <span class="material-symbols-outlined">description</span>
          서류 체크리스트로 이동
        <% end %>
      </div>
    </div>

    <!-- 용역 체크리스트 -->
    <div class="checklist-container" id="checklist-service">
      <div class="summary-card">
        <h2>
          <span class="material-symbols-outlined" style="color: var(--color-indigo-500);">support_agent</span>
          용역 계약 체크리스트
        </h2>
        <div class="summary-stats">
          <div class="stat-item">
            <div class="value" id="service-total">12</div>
            <div class="label">전체 항목</div>
          </div>
          <div class="stat-item completed">
            <div class="value" id="service-completed">0</div>
            <div class="label">완료</div>
          </div>
          <div class="stat-item pending">
            <div class="value" id="service-pending">12</div>
            <div class="label">미완료</div>
          </div>
          <div class="stat-item">
            <div class="value" id="service-percent">0%</div>
            <div class="label">진행률</div>
          </div>
        </div>
        <div class="quick-links">
          <%= link_to contract_method_path, class: "quick-link" do %>
            <span class="material-symbols-outlined">gavel</span>
            계약방식 결정
          <% end %>
          <%= link_to contract_documents_path, class: "quick-link" do %>
            <span class="material-symbols-outlined">description</span>
            서류 체크리스트
          <% end %>
        </div>
      </div>

      <!-- 용역 단계들 -->
      <div class="check-stage" data-type="service">
        <div class="stage-header open" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">1</div>
            <div class="stage-info">
              <h3>기본계획 수립</h3>
              <div class="sub">용역 범위, 기간, 예산 확인</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/1</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body open">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                기본계획 수립 여부
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                용역의 목적, 범위, 기간, 예상 비용 등 기본계획을 수립했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 제7조
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="service">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">2</div>
            <div class="stage-info">
              <h3>과업내용서(과업지시서) 작성</h3>
              <div class="sub">용역 내용, 범위, 산출물 정의</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/1</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                과업내용서(과업지시서) 작성
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                용역 내용, 범위, 투입인력, 성과품(산출물) 목록 등을 구체적으로 명시했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제14조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  과업 내용이 불명확하면 준공 시 분쟁 발생 가능
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  성과품 목록, 제출 형태, 수량 구체적으로 명시
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="service">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">3</div>
            <div class="stage-info">
              <h3>예정가격 작성</h3>
              <div class="sub">원가계산 또는 시장조사</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/2</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                노임단가 적용
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                정부고시 노임단가 또는 한국엔지니어링협회 노임단가를 적용했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행규칙 제8조
              </div>
              <div class="check-tips">
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  추정가격 2천만원 이하 수의계약 시 예정가격 작성 생략 가능 (시행령 제9조)
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                제경비, 기술료 적용
              </div>
              <div class="check-desc">
                원가계산 시 제경비, 기술료 등을 적정하게 반영했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                예정가격 작성기준(기획재정부 고시)
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="service">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">4</div>
            <div class="stage-info">
              <h3>중소기업 용역 확인</h3>
              <div class="sub">중소기업 경쟁 대상 용역</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/1</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                중소기업 경쟁 대상 용역 확인
              </div>
              <div class="check-desc">
                청소, 경비, 시설관리 등 중소기업 의무구매 대상 용역인지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                중소기업제품 구매촉진법 제6조
              </div>
              <div class="check-tips">
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  청소, 경비, 시설관리용역은 중소기업 경쟁 대상
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="service">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">5</div>
            <div class="stage-info">
              <h3>계약방법 결정</h3>
              <div class="sub">입찰/수의계약, 분할계약 검토, 협상에 의한 계약</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/3</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                계약방법 결정
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                추정가격에 따른 적정 계약방법을 결정했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제25조, 제30조
              </div>
              <div class="check-tips">
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  용역: 2,000만원 이하 소액수의계약 가능
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  2천만원 초과 수의계약 시 G2B 전자견적 필수 (시행령 제39조)
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                분할계약(쪼개기) 사전 검토
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                동일 목적의 계약을 여러 건으로 분할하여 수의계약 범위에 맞추는 것은 아닌지 사전 검토합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제25조제6항
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  분할계약은 감사 지적의 가장 대표적인 사례 - 사전준비 단계에서 검토 필수
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                협상에 의한 계약 검토
              </div>
              <div class="check-desc">
                기술용역 등 기술능력 평가가 중요한 경우 협상에 의한 계약 방식을 검토합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제43조
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="service">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">6</div>
            <div class="stage-info">
              <h3>청렴성 검증</h3>
              <div class="sub">체결제한 확인, 부정당업자 조회, 청렴서약서</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/3</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                수의계약 체결 제한 여부 확인서 징구
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                계약상대자가 수의계약 배제사유(부정당업자 제재, 영업정지, 과징금 등)에 해당하는지 확인하고 확인서를 징구합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제25조, 제31조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  배제사유 미확인 시 계약 무효 및 감사 지적 대상
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                부정당업자 제재현황 조회
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                계약상대자가 부정당업자 제재 중인지 나라장터(G2B)에서 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 제31조
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                청렴서약서 징구
              </div>
              <div class="check-desc">
                수의계약 시 청렴서약서를 징구합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행규칙 제42조
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="action-buttons">
        <button class="btn-action primary" onclick="window.print()">
          <span class="material-symbols-outlined">print</span>
          체크리스트 인쇄
        </button>
        <button class="btn-action secondary" onclick="resetChecklist('service')">
          <span class="material-symbols-outlined">refresh</span>
          초기화
        </button>
      </div>
    </div>

    <!-- 공사 체크리스트 -->
    <div class="checklist-container" id="checklist-construction">
      <div class="summary-card">
        <h2>
          <span class="material-symbols-outlined" style="color: var(--color-amber-500);">construction</span>
          공사 계약 체크리스트
        </h2>
        <div class="summary-stats">
          <div class="stat-item">
            <div class="value" id="construction-total">14</div>
            <div class="label">전체 항목</div>
          </div>
          <div class="stat-item completed">
            <div class="value" id="construction-completed">0</div>
            <div class="label">완료</div>
          </div>
          <div class="stat-item pending">
            <div class="value" id="construction-pending">14</div>
            <div class="label">미완료</div>
          </div>
          <div class="stat-item">
            <div class="value" id="construction-percent">0%</div>
            <div class="label">진행률</div>
          </div>
        </div>
        <div class="quick-links">
          <%= link_to contract_method_path, class: "quick-link" do %>
            <span class="material-symbols-outlined">gavel</span>
            계약방식 결정
          <% end %>
          <%= link_to contract_documents_path, class: "quick-link" do %>
            <span class="material-symbols-outlined">description</span>
            서류 체크리스트
          <% end %>
          <a href="https://www.kiscon.net" target="_blank" class="quick-link">
            <span class="material-symbols-outlined">open_in_new</span>
            건설산업종합정보망
          </a>
        </div>
      </div>

      <!-- 공사 단계들 -->
      <div class="check-stage" data-type="construction">
        <div class="stage-header open" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">1</div>
            <div class="stage-info">
              <h3>기본계획 수립</h3>
              <div class="sub">공사 범위, 공법, 예산 확보</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/1</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body open">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                기본계획 수립 여부
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                공사의 목적, 범위, 공법, 공기, 예산 등 기본계획을 수립했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                건설기술진흥법 제48조
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="construction">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">2</div>
            <div class="stage-info">
              <h3>설계서 작성</h3>
              <div class="sub">설계도면, 시방서, 내역서</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/2</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                설계도서 구비
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                설계도면, 시방서, 내역서, 현장설명서 등 설계도서가 완비되었는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                건설기술진흥법 제48조, 지방계약법 시행령 제14조
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                설계금액 검토
              </div>
              <div class="check-desc">
                표준품셈, 실적공사비 등 적정한 방법으로 설계금액이 산정되었는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제7조
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="construction">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">3</div>
            <div class="stage-info">
              <h3>계약방법 결정</h3>
              <div class="sub">입찰/수의계약 방식 결정, 분할계약 검토</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/3</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                계약방법 결정
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                추정가격에 따른 적정 계약방법을 결정했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제25조, 제30조
              </div>
              <div class="check-tips">
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  종합공사: 4억원 이하, 전문공사: 2억원 이하, 기타공사: 1.6억원 이하 수의계약 가능
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  2천만원 초과 수의계약 시 G2B 전자견적 필수 (시행령 제39조)
                </div>
                <div class="tip-item">
                  <span class="material-symbols-outlined">lightbulb</span>
                  추정가격 2천만원 이하 수의계약 시 예정가격 작성 생략 가능 (시행령 제9조)
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                분할계약(쪼개기) 사전 검토
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                동일 목적의 공사를 여러 건으로 분할하여 수의계약 범위에 맞추는 것은 아닌지 사전 검토합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제25조제6항
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  분할계약은 감사 지적의 가장 대표적인 사례 - 사전준비 단계에서 검토 필수
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                건설업 등록 확인
              </div>
              <div class="check-desc">
                해당 공종에 맞는 건설업 등록 업체인지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                건설산업기본법 제9조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  8천만원 이하 경미한 공사도 등록업체 시공 권장
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="construction">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">4</div>
            <div class="stage-info">
              <h3>청렴성 검증</h3>
              <div class="sub">체결제한 확인, 부정당업자 조회, 시공능력 확인</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/3</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                수의계약 체결 제한 여부 확인서 징구
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                계약상대자가 수의계약 배제사유(부정당업자 제재, 영업정지, 과징금 등)에 해당하는지 확인하고 확인서를 징구합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제25조, 제31조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  배제사유 미확인 시 계약 무효 및 감사 지적 대상
                </div>
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                부정당업자 제재현황 조회
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                계약상대자가 부정당업자 제재 중인지 나라장터(G2B)에서 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 제31조
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                시공능력평가 확인
              </div>
              <div class="check-desc">
                입찰 참가 자격으로 시공능력평가액 조건 부여 시 적정 기준인지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                건설산업기본법 제23조
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="construction">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">5</div>
            <div class="stage-info">
              <h3>계약 체결</h3>
              <div class="sub">계약서 작성, 보증서 징구</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/3</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                계약서 작성
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                공사계약서, 공사계약일반조건, 특수조건을 작성합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 제14조
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                계약보증금/이행보증서 징구
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                계약금액의 10% 이상 계약보증금 또는 공사이행보증서를 징구합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제51조
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                보험가입 확인
              </div>
              <div class="check-desc">
                산재·고용보험, 건설공사보험 등 필수 보험 가입 여부를 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                건설산업기본법 제34조
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="check-stage" data-type="construction">
        <div class="stage-header" onclick="toggleStage(this)">
          <div class="left">
            <div class="stage-number">6</div>
            <div class="stage-info">
              <h3>착공 확인</h3>
              <div class="sub">착공계, 안전관리계획서</div>
            </div>
          </div>
          <div class="stage-progress">
            <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
            <span class="progress-text">0/2</span>
            <span class="material-symbols-outlined toggle-icon">expand_more</span>
          </div>
        </div>
        <div class="stage-body">
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                착공계 제출 확인
                <span class="required">필수</span>
              </div>
              <div class="check-desc">
                착공계, 현장대리인 지정 신고서, 공정표 등을 제출받았는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                지방계약법 시행령 제59조
              </div>
            </div>
          </div>
          <div class="check-item" onclick="toggleCheck(this)">
            <div class="check-box">
              <span class="material-symbols-outlined">check</span>
            </div>
            <div class="check-content">
              <div class="check-title">
                안전관리계획서 승인
              </div>
              <div class="check-desc">
                공사금액 1억원 이상 시 안전관리계획서를 승인했는지 확인합니다.
              </div>
              <div class="legal-basis">
                <span class="material-symbols-outlined">gavel</span>
                건설기술진흥법 제62조
              </div>
              <div class="check-tips">
                <div class="tip-item warning">
                  <span class="material-symbols-outlined">warning</span>
                  안전관리계획 미수립 시 과태료 및 사고 발생 시 책임 문제
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="action-buttons">
        <button class="btn-action primary" onclick="window.print()">
          <span class="material-symbols-outlined">print</span>
          체크리스트 인쇄
        </button>
        <button class="btn-action secondary" onclick="resetChecklist('construction')">
          <span class="material-symbols-outlined">refresh</span>
          초기화
        </button>
      </div>
    </div>

  </div>
</section>

<script>
  // 탭 전환
  function showChecklist(tab) {
    document.querySelectorAll('.checklist-tab').forEach(t => {
      t.classList.toggle('active', t.dataset.tab === tab);
    });
    document.querySelectorAll('.checklist-container').forEach(c => {
      c.classList.remove('active');
    });
    document.getElementById('checklist-' + tab).classList.add('active');
  }

  // 단계 토글
  function toggleStage(header) {
    header.classList.toggle('open');
    const body = header.nextElementSibling;
    body.classList.toggle('open');
  }

  // 체크 토글
  function toggleCheck(item) {
    item.classList.toggle('checked');
    updateProgress();
    saveState();
  }

  // 진행률 업데이트
  function updateProgress() {
    ['goods', 'service', 'construction'].forEach(type => {
      const container = document.getElementById('checklist-' + type);
      if (!container) return;

      const stages = container.querySelectorAll('.check-stage[data-type="' + type + '"]');
      let totalChecked = 0;
      let totalItems = 0;

      stages.forEach(stage => {
        const items = stage.querySelectorAll('.check-item');
        const checked = stage.querySelectorAll('.check-item.checked');

        // 단계별 진행률 업데이트
        const progressFill = stage.querySelector('.progress-fill');
        const progressText = stage.querySelector('.progress-text');
        if (progressFill && progressText) {
          const percent = items.length > 0 ? (checked.length / items.length) * 100 : 0;
          progressFill.style.width = percent + '%';
          progressText.textContent = checked.length + '/' + items.length;
        }

        totalChecked += checked.length;
        totalItems += items.length;
      });

      // 전체 통계 업데이트
      const totalEl = document.getElementById(type + '-total');
      const completedEl = document.getElementById(type + '-completed');
      const pendingEl = document.getElementById(type + '-pending');
      const percentEl = document.getElementById(type + '-percent');

      if (totalEl) totalEl.textContent = totalItems;
      if (completedEl) completedEl.textContent = totalChecked;
      if (pendingEl) pendingEl.textContent = totalItems - totalChecked;
      if (percentEl) {
        const percent = totalItems > 0 ? Math.round((totalChecked / totalItems) * 100) : 0;
        percentEl.textContent = percent + '%';
      }
    });
  }

  // 상태 저장
  function saveState() {
    const state = {};
    document.querySelectorAll('.check-item').forEach((item, index) => {
      state[index] = item.classList.contains('checked');
    });
    localStorage.setItem('preContractChecklist', JSON.stringify(state));
  }

  // 상태 복원
  function loadState() {
    const state = JSON.parse(localStorage.getItem('preContractChecklist') || '{}');
    document.querySelectorAll('.check-item').forEach((item, index) => {
      if (state[index]) {
        item.classList.add('checked');
      }
    });
    updateProgress();
  }

  // 초기화
  function resetChecklist(type) {
    const container = document.getElementById('checklist-' + type);
    if (!container) return;

    container.querySelectorAll('.check-item').forEach(item => {
      item.classList.remove('checked');
    });
    updateProgress();
    saveState();
  }

  // 페이지 로드 시 상태 복원
  document.addEventListener('turbo:load', loadState);
</script>
