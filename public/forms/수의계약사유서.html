<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìˆ˜ì˜ê³„ì•½ ìš”ì²­ ì‚¬ìœ ì„œ</title>
  <style>
    @page { size: A4; margin: 20mm; }
    * { box-sizing: border-box; }
    body { font-family: 'ë§‘ì€ ê³ ë”•', 'Malgun Gothic', sans-serif; font-size: 12pt; line-height: 1.6; margin: 0; padding: 0; background: #f5f5f5; }
    .toolbar { background: #1e40af; color: white; padding: 15px 20px; position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center; }
    .toolbar-left { display: flex; align-items: center; gap: 20px; }
    .toolbar h2 { margin: 0; font-size: 16pt; }
    .toolbar-nav { display: flex; gap: 5px; }
    .toolbar-nav a { color: rgba(255,255,255,0.8); text-decoration: none; padding: 6px 12px; border-radius: 6px; font-size: 10pt; transition: all 0.2s; display: flex; align-items: center; gap: 6px; }
    .toolbar-nav a:hover { background: rgba(255,255,255,0.2); color: white; }
    .toolbar-nav a svg { width: 16px; height: 16px; }
    .toolbar-divider { width: 1px; height: 24px; background: rgba(255,255,255,0.3); }
    .toolbar-buttons { display: flex; gap: 10px; }
    .toolbar button { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 11pt; font-weight: 500; }
    .btn-save { background: #10b981; color: white; }
    .btn-load { background: #6366f1; color: white; }
    .btn-print { background: #f59e0b; color: white; }
    .btn-clear { background: #ef4444; color: white; }
    .btn-download { background: #8b5cf6; color: white; }
    .container { max-width: 800px; margin: 20px auto; padding: 40px; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1 { text-align: center; font-size: 20pt; margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 10px; }
    .form-info { margin-bottom: 20px; text-align: right; font-size: 10pt; color: #666; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #000; padding: 10px; text-align: left; }
    th { background-color: #f5f5f5; width: 130px; text-align: center; vertical-align: middle; }
    input[type="text"], input[type="date"], textarea { width: 100%; border: none; background: #fffef0; padding: 5px; font-size: 12pt; font-family: inherit; }
    input[type="text"]:focus, textarea:focus { outline: 2px solid #3b82f6; background: #fff; }
    textarea { min-height: 80px; resize: vertical; }
    .checkbox-group label { display: block; margin: 5px 0; cursor: pointer; }
    .checkbox-group input[type="checkbox"] { margin-right: 8px; transform: scale(1.2); }
    .signature-area { margin-top: 40px; }
    .signature-table { width: 60%; margin-left: auto; }
    .signature-table th, .signature-table td { height: 60px; text-align: center; }
    .date-area { text-align: center; margin: 30px 0; font-size: 14pt; }
    .date-area input { width: 60px; text-align: center; }
    .legal-note { background-color: #f0f9ff; padding: 15px; margin-top: 20px; font-size: 10pt; border: 1px solid #bae6fd; border-radius: 8px; }
    .toast { position: fixed; bottom: 20px; right: 20px; padding: 15px 25px; border-radius: 8px; color: white; font-weight: 500; opacity: 0; transition: opacity 0.3s; z-index: 1000; }
    .toast.show { opacity: 1; }
    .toast.success { background: #10b981; }
    .toast.info { background: #3b82f6; }
    @media print {
      .toolbar, .legal-note { display: none !important; }
      body { background: white; }
      .container { box-shadow: none; margin: 0; padding: 20px; }
      input[type="text"], input[type="date"], textarea { background: transparent; border-bottom: 1px solid #ccc; }
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <div class="toolbar-left">
      <nav class="toolbar-nav">
        <a href="/">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
          í™ˆ
        </a>
        <a href="/topics/private-contract">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
          ìˆ˜ì˜ê³„ì•½ ê°€ì´ë“œ
        </a>
      </nav>
      <div class="toolbar-divider"></div>
      <h2>ìˆ˜ì˜ê³„ì•½ ìš”ì²­ ì‚¬ìœ ì„œ</h2>
    </div>
    <div class="toolbar-buttons">
      <button class="btn-save" onclick="saveForm()">ğŸ’¾ ì €ì¥</button>
      <button class="btn-load" onclick="loadForm()">ğŸ“‚ ë¶ˆëŸ¬ì˜¤ê¸°</button>
      <button class="btn-download" onclick="downloadAsDocx()">â¬‡ï¸ Wordì €ì¥ (í•œê¸€ í˜¸í™˜)</button>
      <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„/PDF</button>
      <button class="btn-clear" onclick="clearForm()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
    </div>
  </div>

  <div class="container" id="form-container">
    <div class="form-info">[ë³„ì§€ ì œ5í˜¸ ì„œì‹]</div>
    <h1>ìˆ˜ì˜ê³„ì•½ ìš”ì²­ ì‚¬ìœ ì„œ</h1>

    <table>
      <tr>
        <th>ê³„ì•½ê±´ëª…</th>
        <td colspan="3"><input type="text" id="contract_name" placeholder="ì˜ˆ: 2026ë…„ë„ ì‚¬ë¬´ìš©í’ˆ êµ¬ë§¤"></td>
      </tr>
      <tr>
        <th>ê³„ì•½êµ¬ë¶„</th>
        <td>
          <label><input type="checkbox" id="type_goods"> ë¬¼í’ˆ</label>&nbsp;&nbsp;
          <label><input type="checkbox" id="type_service"> ìš©ì—­</label>&nbsp;&nbsp;
          <label><input type="checkbox" id="type_construction"> ê³µì‚¬</label>
        </td>
        <th>ì¶”ì •ê°€ê²©</th>
        <td><input type="text" id="estimated_price" placeholder="15,000,000"> ì›</td>
      </tr>
      <tr>
        <th>ê³„ì•½ê¸°ê°„</th>
        <td colspan="3">
          <input type="date" id="contract_start" style="width: 150px;"> ~ <input type="date" id="contract_end" style="width: 150px;">
        </td>
      </tr>
      <tr>
        <th>ê³„ì•½ìƒëŒ€ì</th>
        <td><input type="text" id="contractor_name" placeholder="(ì£¼)OOìƒì‚¬"></td>
        <th>ëŒ€í‘œì</th>
        <td><input type="text" id="contractor_ceo" placeholder="í™ê¸¸ë™"></td>
      </tr>
      <tr>
        <th>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</th>
        <td><input type="text" id="business_number" placeholder="123-45-67890"></td>
        <th>ì—°ë½ì²˜</th>
        <td><input type="text" id="contact" placeholder="02-1234-5678"></td>
      </tr>
    </table>

    <table>
      <tr>
        <th>ìˆ˜ì˜ê³„ì•½<br>ë²•ì ê·¼ê±°</th>
        <td class="checkbox-group">
          <p><strong>ì§€ë°©ê³„ì•½ë²• ì‹œí–‰ë ¹ ì œ25ì¡° ì œ1í•­</strong></p>
          <label><input type="checkbox" id="legal_1"> ì œ1í˜¸: ì²œì¬ì§€ë³€, ê¸´ê¸‰í•œ í–‰ì‚¬ ë“± ê²½ìŸì— ë¶€ì¹  ì—¬ìœ ê°€ ì—†ëŠ” ê²½ìš°</label>
          <label><input type="checkbox" id="legal_2"> ì œ2í˜¸: êµ­ê°€ê¸°ê´€, ë‹¤ë¥¸ ì§€ë°©ìì¹˜ë‹¨ì²´ì™€ ê³„ì•½í•˜ëŠ” ê²½ìš°</label>
          <label><input type="checkbox" id="legal_3"> ì œ3í˜¸: íŠ¹ì •ì¸ì˜ ê¸°ìˆ /ìš©ì—­ ë˜ëŠ” íŠ¹ì • ìœ„ì¹˜/êµ¬ì¡° ë“±ìœ¼ë¡œ ê²½ìŸ ë¶ˆê°€</label>
          <label><input type="checkbox" id="legal_4"> ì œ4í˜¸: ì¶”ì •ê°€ê²©ì´ ìˆ˜ì˜ê³„ì•½ ê¸°ì¤€ê¸ˆì•¡ ì´í•˜ì¸ ê²½ìš°</label>
          <label><input type="checkbox" id="legal_etc"> ê¸°íƒ€: <input type="text" id="legal_etc_text" style="width: 300px;" placeholder="ê¸°íƒ€ ì‚¬ìœ  ì…ë ¥"></label>
        </td>
      </tr>
    </table>

    <table>
      <tr>
        <th>ìˆ˜ì˜ê³„ì•½<br>ìš”ì²­ì‚¬ìœ </th>
        <td>
          <textarea id="request_reason" placeholder="ì˜ˆ: ë³¸ ê±´ì€ ì¶”ì •ê°€ê²© 15,000,000ì›ìœ¼ë¡œ ì§€ë°©ê³„ì•½ë²• ì‹œí–‰ë ¹ ì œ25ì¡° ì œ1í•­ ì œ4í˜¸ì— ë”°ë¥¸ ë¬¼í’ˆêµ¬ë§¤ ìˆ˜ì˜ê³„ì•½ ê¸°ì¤€ê¸ˆì•¡(2,200ë§Œì›) ì´í•˜ì— í•´ë‹¹í•˜ì—¬ ìˆ˜ì˜ê³„ì•½ìœ¼ë¡œ ì§„í–‰í•˜ê³ ì í•©ë‹ˆë‹¤."></textarea>
        </td>
      </tr>
    </table>

    <table>
      <tr>
        <th>ê³„ì•½ìƒëŒ€ì<br>ì„ ì •ì‚¬ìœ </th>
        <td>
          <textarea id="selection_reason" placeholder="ì˜ˆ: (ì£¼)OOìƒì‚¬ëŠ” ë‹¹ ê¸°ê´€ê³¼ ë‹¤ë…„ê°„ ê±°ë˜ ì‹¤ì ì´ ìˆìœ¼ë©°, ìµœì €ê°€ ê²¬ì ì„ ì œì¶œí•˜ì—¬ ê³„ì•½ìƒëŒ€ìë¡œ ì„ ì •í•˜ì˜€ìŠµë‹ˆë‹¤."></textarea>
        </td>
      </tr>
    </table>

    <table>
      <tr>
        <th>ì²¨ë¶€ì„œë¥˜</th>
        <td class="checkbox-group">
          <label><input type="checkbox" id="attach_1"> ê²¬ì ì„œ <input type="text" id="attach_1_count" style="width: 30px; text-align: center;">ë¶€</label>
          <label><input type="checkbox" id="attach_2"> ì‚¬ì—…ìë“±ë¡ì¦ ì‚¬ë³¸</label>
          <label><input type="checkbox" id="attach_3"> ì˜ˆì •ê°€ê²© ì¡°ì„œ</label>
          <label><input type="checkbox" id="attach_etc"> ê¸°íƒ€: <input type="text" id="attach_etc_text" style="width: 200px;"></label>
        </td>
      </tr>
    </table>

    <div class="date-area">
      <p>ìœ„ì™€ ê°™ì´ ìˆ˜ì˜ê³„ì•½ì„ ìš”ì²­í•©ë‹ˆë‹¤.</p>
      <p style="margin-top: 20px;">
        <input type="text" id="year" style="width: 60px;" placeholder="2026">ë…„
        <input type="text" id="month" style="width: 40px;" placeholder="2">ì›”
        <input type="text" id="day" style="width: 40px;" placeholder="2">ì¼
      </p>
    </div>

    <div class="signature-area">
      <p style="text-align: center; margin-bottom: 10px;"><strong>ìš”ì²­ë¶€ì„œ:</strong> <input type="text" id="department" style="width: 200px;" placeholder="ì´ë¬´ê³¼"></p>
      <table class="signature-table">
        <tr>
          <th><input type="text" id="title_1" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="ë‹´ë‹¹"></th>
          <th><input type="text" id="title_2" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="íŒ€ì¥"></th>
          <th><input type="text" id="title_3" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="ê³¼ì¥"></th>
        </tr>
        <tr>
          <td><input type="text" id="sign_1" style="text-align: center;" placeholder="(ì¸)"></td>
          <td><input type="text" id="sign_2" style="text-align: center;" placeholder="(ì¸)"></td>
          <td><input type="text" id="sign_3" style="text-align: center;" placeholder="(ì¸)"></td>
        </tr>
      </table>
    </div>

    <div class="legal-note">
      <strong>ğŸ’¡ ì‘ì„± ë„ì›€ë§</strong>
      <ul style="margin: 10px 0;">
        <li><strong>ì €ì¥:</strong> ì‘ì„± ë‚´ìš©ì„ ë¸Œë¼ìš°ì €ì— ì„ì‹œ ì €ì¥í•©ë‹ˆë‹¤.</li>
        <li><strong>ë¶ˆëŸ¬ì˜¤ê¸°:</strong> ì €ì¥ëœ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.</li>
        <li><strong>Wordì €ì¥:</strong> Word íŒŒì¼(.docx)ë¡œ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤. í•œê¸€(HWP)ì—ì„œë„ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
        <li><strong>ì¸ì‡„/PDF:</strong> ì¸ì‡„í•˜ê±°ë‚˜ PDFë¡œ ì €ì¥í•©ë‹ˆë‹¤. (ì¸ì‡„ ëŒ€í™”ìƒìì—ì„œ "PDFë¡œ ì €ì¥" ì„ íƒ)</li>
      </ul>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>
  <script>
    // ëª¨ë“  input ìš”ì†Œì˜ ID ëª©ë¡
    const inputIds = [
      'contract_name', 'type_goods', 'type_service', 'type_construction',
      'estimated_price', 'contract_start', 'contract_end',
      'contractor_name', 'contractor_ceo', 'business_number', 'contact',
      'legal_1', 'legal_2', 'legal_3', 'legal_4', 'legal_etc', 'legal_etc_text',
      'request_reason', 'selection_reason',
      'attach_1', 'attach_1_count', 'attach_2', 'attach_3', 'attach_etc', 'attach_etc_text',
      'year', 'month', 'day', 'department', 'title_1', 'title_2', 'title_3', 'sign_1', 'sign_2', 'sign_3'
    ];

    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type} show`;
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    function getFormData() {
      const data = {};
      inputIds.forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          data[id] = el.type === 'checkbox' ? el.checked : el.value;
        }
      });
      return data;
    }

    function setFormData(data) {
      inputIds.forEach(id => {
        const el = document.getElementById(id);
        if (el && data[id] !== undefined) {
          if (el.type === 'checkbox') {
            el.checked = data[id];
          } else {
            el.value = data[id];
          }
        }
      });
    }

    function saveForm() {
      const data = getFormData();
      localStorage.setItem('ìˆ˜ì˜ê³„ì•½ì‚¬ìœ ì„œ', JSON.stringify(data));
      showToast('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
    }

    function loadForm() {
      const saved = localStorage.getItem('ìˆ˜ì˜ê³„ì•½ì‚¬ìœ ì„œ');
      if (saved) {
        setFormData(JSON.parse(saved));
        showToast('ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!', 'info');
      } else {
        showToast('ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', 'info');
      }
    }

    function clearForm() {
      if (confirm('ëª¨ë“  ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        const defaults = { title_1: 'ë‹´ë‹¹', title_2: 'íŒ€ì¥', title_3: 'ê³¼ì¥' };
        inputIds.forEach(id => {
          const el = document.getElementById(id);
          if (el) {
            if (el.type === 'checkbox') el.checked = false;
            else if (defaults[id]) el.value = defaults[id];
            else el.value = '';
          }
        });
        showToast('ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
      }
    }

    async function downloadAsDocx() {
      const data = getFormData();
      const { Document, Packer, Paragraph, TextRun, Table, TableRow, TableCell, WidthType, AlignmentType, BorderStyle } = docx;

      // ê³„ì•½êµ¬ë¶„ í…ìŠ¤íŠ¸
      let contractType = [];
      if (data.type_goods) contractType.push('ë¬¼í’ˆ');
      if (data.type_service) contractType.push('ìš©ì—­');
      if (data.type_construction) contractType.push('ê³µì‚¬');

      // ë²•ì ê·¼ê±° í…ìŠ¤íŠ¸
      let legalBasis = [];
      if (data.legal_1) legalBasis.push('ì œ1í˜¸: ì²œì¬ì§€ë³€, ê¸´ê¸‰í•œ í–‰ì‚¬ ë“±');
      if (data.legal_2) legalBasis.push('ì œ2í˜¸: êµ­ê°€ê¸°ê´€, ë‹¤ë¥¸ ì§€ë°©ìì¹˜ë‹¨ì²´ì™€ ê³„ì•½');
      if (data.legal_3) legalBasis.push('ì œ3í˜¸: íŠ¹ì •ì¸ì˜ ê¸°ìˆ /ìš©ì—­');
      if (data.legal_4) legalBasis.push('ì œ4í˜¸: ì¶”ì •ê°€ê²©ì´ ê¸°ì¤€ê¸ˆì•¡ ì´í•˜');
      if (data.legal_etc) legalBasis.push('ê¸°íƒ€: ' + (data.legal_etc_text || ''));

      const doc = new Document({
        sections: [{
          properties: {},
          children: [
            new Paragraph({
              children: [new TextRun({ text: 'ìˆ˜ì˜ê³„ì•½ ìš”ì²­ ì‚¬ìœ ì„œ', bold: true, size: 36 })],
              alignment: AlignmentType.CENTER,
              spacing: { after: 400 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ê³„ì•½ê±´ëª…: ${data.contract_name || ''}`, size: 24 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ê³„ì•½êµ¬ë¶„: ${contractType.join(', ') || '-'}`, size: 24 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ì¶”ì •ê°€ê²©: ${data.estimated_price || ''} ì›`, size: 24 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ê³„ì•½ê¸°ê°„: ${data.contract_start || ''} ~ ${data.contract_end || ''}`, size: 24 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ê³„ì•½ìƒëŒ€ì: ${data.contractor_name || ''} (ëŒ€í‘œ: ${data.contractor_ceo || ''})`, size: 24 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: ${data.business_number || ''}`, size: 24 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ì—°ë½ì²˜: ${data.contact || ''}`, size: 24 })],
              spacing: { after: 400 }
            }),
            new Paragraph({
              children: [new TextRun({ text: 'ìˆ˜ì˜ê³„ì•½ ë²•ì ê·¼ê±° (ì§€ë°©ê³„ì•½ë²• ì‹œí–‰ë ¹ ì œ25ì¡° ì œ1í•­)', bold: true, size: 24 })],
              spacing: { after: 200 }
            }),
            ...legalBasis.map(item => new Paragraph({
              children: [new TextRun({ text: `â€¢ ${item}`, size: 24 })],
              spacing: { after: 100 }
            })),
            new Paragraph({
              children: [new TextRun({ text: 'ìˆ˜ì˜ê³„ì•½ ìš”ì²­ì‚¬ìœ ', bold: true, size: 24 })],
              spacing: { before: 300, after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: data.request_reason || '', size: 24 })],
              spacing: { after: 300 }
            }),
            new Paragraph({
              children: [new TextRun({ text: 'ê³„ì•½ìƒëŒ€ì ì„ ì •ì‚¬ìœ ', bold: true, size: 24 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: data.selection_reason || '', size: 24 })],
              spacing: { after: 400 }
            }),
            new Paragraph({
              children: [new TextRun({ text: 'ìœ„ì™€ ê°™ì´ ìˆ˜ì˜ê³„ì•½ì„ ìš”ì²­í•©ë‹ˆë‹¤.', size: 24 })],
              alignment: AlignmentType.CENTER,
              spacing: { after: 300 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `${data.year || ''}ë…„ ${data.month || ''}ì›” ${data.day || ''}ì¼`, size: 24 })],
              alignment: AlignmentType.CENTER,
              spacing: { after: 300 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ìš”ì²­ë¶€ì„œ: ${data.department || ''}`, size: 24 })],
              alignment: AlignmentType.CENTER,
              spacing: { after: 400 }
            }),
            new Paragraph({
              children: [
                new TextRun({ text: `${data.title_1 || 'ë‹´ë‹¹'}: ${data.sign_1 || '(ì¸)'}    `, size: 22 }),
                new TextRun({ text: `${data.title_2 || 'íŒ€ì¥'}: ${data.sign_2 || '(ì¸)'}    `, size: 22 }),
                new TextRun({ text: `${data.title_3 || 'ê³¼ì¥'}: ${data.sign_3 || '(ì¸)'}`, size: 22 })
              ],
              alignment: AlignmentType.RIGHT
            })
          ]
        }]
      });

      const blob = await Packer.toBlob(doc);
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `ìˆ˜ì˜ê³„ì•½ì‚¬ìœ ì„œ_${data.contract_name || 'ì‘ì„±ì¤‘'}.docx`;
      a.click();
      URL.revokeObjectURL(url);
      showToast('Word íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
    }

    // ìë™ ì €ì¥ (30ì´ˆë§ˆë‹¤)
    setInterval(() => {
      const data = getFormData();
      if (Object.values(data).some(v => v)) {
        localStorage.setItem('ìˆ˜ì˜ê³„ì•½ì‚¬ìœ ì„œ_ìë™ì €ì¥', JSON.stringify(data));
      }
    }, 30000);

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ì €ì¥ ë°ì´í„° í™•ì¸
    window.onload = function() {
      const autoSaved = localStorage.getItem('ìˆ˜ì˜ê³„ì•½ì‚¬ìœ ì„œ_ìë™ì €ì¥');
      if (autoSaved) {
        const data = JSON.parse(autoSaved);
        if (Object.values(data).some(v => v)) {
          if (confirm('ìë™ ì €ì¥ëœ ë‚´ìš©ì´ ìˆìŠµë‹ˆë‹¤. ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            setFormData(data);
          }
        }
      }
    };
  </script>
</body>
</html>
