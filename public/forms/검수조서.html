<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê²€ìˆ˜ì¡°ì„œ</title>
  <style>
    @page { size: A4; margin: 20mm; }
    * { box-sizing: border-box; }
    body { font-family: 'ë§‘ì€ ê³ ë”•', 'Malgun Gothic', sans-serif; font-size: 12pt; line-height: 1.6; margin: 0; padding: 0; background: #f5f5f5; }
    .toolbar { background: #7c3aed; color: white; padding: 15px 20px; position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center; }
    .toolbar-left { display: flex; align-items: center; gap: 20px; }
    .toolbar h2 { margin: 0; font-size: 16pt; }
    .toolbar-nav { display: flex; gap: 5px; }
    .toolbar-nav a { color: rgba(255,255,255,0.8); text-decoration: none; padding: 6px 12px; border-radius: 6px; font-size: 10pt; transition: all 0.2s; display: flex; align-items: center; gap: 6px; }
    .toolbar-nav a:hover { background: rgba(255,255,255,0.2); color: white; }
    .toolbar-nav a svg { width: 16px; height: 16px; }
    .toolbar-divider { width: 1px; height: 24px; background: rgba(255,255,255,0.3); }
    .toolbar-buttons { display: flex; gap: 10px; }
    .toolbar button { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 11pt; font-weight: 500; }
    .btn-save { background: #10b981; color: white; }
    .btn-load { background: #6366f1; color: white; }
    .btn-print { background: #f59e0b; color: white; }
    .btn-clear { background: #ef4444; color: white; }
    .btn-download { background: #8b5cf6; color: white; }
    .container { max-width: 800px; margin: 20px auto; padding: 40px; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1 { text-align: center; font-size: 20pt; margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 10px; }
    h3 { margin-top: 20px; margin-bottom: 10px; color: #5b21b6; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
    th, td { border: 1px solid #000; padding: 8px; }
    th { background-color: #ede9fe; text-align: center; }
    input[type="text"], input[type="number"], input[type="date"], textarea { width: 100%; border: none; background: #faf5ff; padding: 5px; font-size: 12pt; font-family: inherit; }
    input:focus, textarea:focus { outline: 2px solid #7c3aed; background: #fff; }
    textarea { min-height: 60px; resize: vertical; }
    .right { text-align: right; }
    .center { text-align: center; }
    .result-box { padding: 20px; text-align: center; margin: 20px 0; border-radius: 10px; }
    .result-pass { background: #dcfce7; border: 3px solid #22c55e; }
    .result-fail { background: #fee2e2; border: 3px solid #ef4444; }
    .result-pending { background: #f3f4f6; border: 3px solid #9ca3af; }
    .result-label { font-size: 18pt; font-weight: bold; }
    .signature-area { margin-top: 30px; }
    .signature-table { width: 80%; margin: 0 auto; }
    .signature-table th, .signature-table td { height: 55px; text-align: center; }
    .date-area { text-align: center; margin: 25px 0; }
    .toast { position: fixed; bottom: 20px; right: 20px; padding: 15px 25px; border-radius: 8px; color: white; font-weight: 500; opacity: 0; transition: opacity 0.3s; z-index: 1000; }
    .toast.show { opacity: 1; }
    .toast.success { background: #7c3aed; }
    .help { background-color: #f5f3ff; padding: 12px; margin-top: 20px; font-size: 10pt; border: 1px solid #ddd6fe; border-radius: 6px; }
    .radio-group { display: flex; gap: 20px; justify-content: center; }
    .radio-group label { cursor: pointer; padding: 10px 20px; border-radius: 8px; border: 2px solid #ddd; }
    .radio-group input[type="radio"] { margin-right: 8px; transform: scale(1.3); }
    .radio-group input[type="radio"]:checked + span { font-weight: bold; }
    @media print {
      .toolbar, .help { display: none !important; }
      body { background: white; }
      .container { box-shadow: none; margin: 0; padding: 20px; }
      input, textarea { background: transparent !important; }
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <div class="toolbar-left">
      <nav class="toolbar-nav">
        <a href="/">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
          í™ˆ
        </a>
        <a href="/topics/private-contract">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
          ìˆ˜ì˜ê³„ì•½ ê°€ì´ë“œ
        </a>
      </nav>
      <div class="toolbar-divider"></div>
      <h2>ê²€ìˆ˜ì¡°ì„œ</h2>
    </div>
    <div class="toolbar-buttons">
      <button class="btn-save" onclick="saveForm()">ğŸ’¾ ì €ì¥</button>
      <button class="btn-load" onclick="loadForm()">ğŸ“‚ ë¶ˆëŸ¬ì˜¤ê¸°</button>
      <button class="btn-download" onclick="downloadAsDocx()">â¬‡ï¸ Wordì €ì¥ (í•œê¸€ í˜¸í™˜)</button>
      <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„/PDF</button>
      <button class="btn-clear" onclick="clearForm()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
    </div>
  </div>

  <div class="container">
    <h1>ê²€ ìˆ˜ ì¡° ì„œ</h1>

    <table>
      <tr>
        <th style="width: 110px;">ê³„ì•½ê±´ëª…</th>
        <td colspan="3"><input type="text" id="contract_name" placeholder="ì˜ˆ: 2026ë…„ë„ ì‚¬ë¬´ìš©í’ˆ êµ¬ë§¤"></td>
      </tr>
      <tr>
        <th>ê³„ì•½ë²ˆí˜¸</th>
        <td><input type="text" id="contract_number" placeholder="2026-ì´ë¬´-001"></td>
        <th style="width: 90px;">ê³„ì•½ê¸ˆì•¡</th>
        <td><input type="number" id="contract_amount" placeholder="15000000"> ì›</td>
      </tr>
      <tr>
        <th>ê³„ì•½ìƒëŒ€ì</th>
        <td><input type="text" id="contractor" placeholder="(ì£¼)OOìƒì‚¬"></td>
        <th>ëŒ€í‘œì</th>
        <td><input type="text" id="contractor_ceo" placeholder="í™ê¸¸ë™"></td>
      </tr>
      <tr>
        <th>ê³„ì•½ê¸°ê°„</th>
        <td colspan="3">
          <input type="date" id="contract_start" style="width: 140px;"> ~ <input type="date" id="contract_end" style="width: 140px;">
        </td>
      </tr>
      <tr>
        <th>ë‚©í’ˆ(ì™„ë£Œ)ì¼</th>
        <td><input type="date" id="delivery_date"></td>
        <th>ê²€ìˆ˜ì¼</th>
        <td><input type="date" id="inspection_date"></td>
      </tr>
    </table>

    <h3>ê²€ìˆ˜ ë‚´ì—­</h3>
    <table>
      <thead>
        <tr>
          <th style="width: 35px;">No</th>
          <th>í’ˆëª… ë° ê·œê²©</th>
          <th style="width: 50px;">ë‹¨ìœ„</th>
          <th style="width: 60px;">ê³„ì•½<br>ìˆ˜ëŸ‰</th>
          <th style="width: 60px;">ë‚©í’ˆ<br>ìˆ˜ëŸ‰</th>
          <th style="width: 60px;">ê²€ìˆ˜<br>ìˆ˜ëŸ‰</th>
          <th style="width: 70px;">ê²°ê³¼</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="center">1</td>
          <td><input type="text" id="item_1_name"></td>
          <td><input type="text" id="item_1_unit" class="center" placeholder="EA"></td>
          <td><input type="number" id="item_1_contract" class="center"></td>
          <td><input type="number" id="item_1_delivery" class="center"></td>
          <td><input type="number" id="item_1_inspect" class="center"></td>
          <td>
            <select id="item_1_result" style="width: 100%; padding: 3px;">
              <option value="">ì„ íƒ</option>
              <option value="pass">í•©ê²©</option>
              <option value="fail">ë¶ˆí•©ê²©</option>
            </select>
          </td>
        </tr>
        <tr>
          <td class="center">2</td>
          <td><input type="text" id="item_2_name"></td>
          <td><input type="text" id="item_2_unit" class="center"></td>
          <td><input type="number" id="item_2_contract" class="center"></td>
          <td><input type="number" id="item_2_delivery" class="center"></td>
          <td><input type="number" id="item_2_inspect" class="center"></td>
          <td>
            <select id="item_2_result" style="width: 100%; padding: 3px;">
              <option value="">ì„ íƒ</option>
              <option value="pass">í•©ê²©</option>
              <option value="fail">ë¶ˆí•©ê²©</option>
            </select>
          </td>
        </tr>
        <tr>
          <td class="center">3</td>
          <td><input type="text" id="item_3_name"></td>
          <td><input type="text" id="item_3_unit" class="center"></td>
          <td><input type="number" id="item_3_contract" class="center"></td>
          <td><input type="number" id="item_3_delivery" class="center"></td>
          <td><input type="number" id="item_3_inspect" class="center"></td>
          <td>
            <select id="item_3_result" style="width: 100%; padding: 3px;">
              <option value="">ì„ íƒ</option>
              <option value="pass">í•©ê²©</option>
              <option value="fail">ë¶ˆí•©ê²©</option>
            </select>
          </td>
        </tr>
        <tr>
          <td class="center">4</td>
          <td><input type="text" id="item_4_name"></td>
          <td><input type="text" id="item_4_unit" class="center"></td>
          <td><input type="number" id="item_4_contract" class="center"></td>
          <td><input type="number" id="item_4_delivery" class="center"></td>
          <td><input type="number" id="item_4_inspect" class="center"></td>
          <td>
            <select id="item_4_result" style="width: 100%; padding: 3px;">
              <option value="">ì„ íƒ</option>
              <option value="pass">í•©ê²©</option>
              <option value="fail">ë¶ˆí•©ê²©</option>
            </select>
          </td>
        </tr>
        <tr>
          <td class="center">5</td>
          <td><input type="text" id="item_5_name"></td>
          <td><input type="text" id="item_5_unit" class="center"></td>
          <td><input type="number" id="item_5_contract" class="center"></td>
          <td><input type="number" id="item_5_delivery" class="center"></td>
          <td><input type="number" id="item_5_inspect" class="center"></td>
          <td>
            <select id="item_5_result" style="width: 100%; padding: 3px;">
              <option value="">ì„ íƒ</option>
              <option value="pass">í•©ê²©</option>
              <option value="fail">ë¶ˆí•©ê²©</option>
            </select>
          </td>
        </tr>
      </tbody>
    </table>

    <h3>ê²€ìˆ˜ ì˜ê²¬</h3>
    <table>
      <tr>
        <td>
          <textarea id="inspection_opinion" placeholder="ì˜ˆ: ë‚©í’ˆëœ ë¬¼í’ˆì„ í™•ì¸í•œ ê²°ê³¼, ê³„ì•½ì„œ ë° ê·œê²©ì„œì— ëª…ì‹œëœ ê·œê²©/ìˆ˜ëŸ‰ê³¼ ì¼ì¹˜í•˜ë©°, í’ˆì§ˆ ìƒíƒœê°€ ì–‘í˜¸í•˜ì—¬ í•©ê²© ì²˜ë¦¬í•¨."></textarea>
        </td>
      </tr>
    </table>

    <div id="result-box" class="result-box result-pending">
      <p style="margin-bottom: 10px;">ê²€ìˆ˜ê²°ê³¼</p>
      <div class="radio-group">
        <label style="background: #dcfce7;">
          <input type="radio" name="final_result" value="pass" onchange="updateResult()">
          <span style="color: #16a34a;">âœ“ í•©ê²©</span>
        </label>
        <label style="background: #fee2e2;">
          <input type="radio" name="final_result" value="fail" onchange="updateResult()">
          <span style="color: #dc2626;">âœ— ë¶ˆí•©ê²©</span>
        </label>
      </div>
    </div>

    <p style="text-align: center; margin: 20px 0;">ìœ„ì™€ ê°™ì´ ê²€ìˆ˜í•˜ì˜€ìŒì„ í™•ì¸í•©ë‹ˆë‹¤.</p>

    <div class="date-area">
      <p>
        <input type="text" id="year" style="width: 60px; text-align: center;" placeholder="2026">ë…„
        <input type="text" id="month" style="width: 40px; text-align: center;" placeholder="2">ì›”
        <input type="text" id="day" style="width: 40px; text-align: center;" placeholder="2">ì¼
      </p>
    </div>

    <div class="signature-area">
      <table class="signature-table">
        <tr>
          <th colspan="3" style="background: #f3f4f6;"><input type="text" id="group_1" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="ê²€ìˆ˜ì"></th>
          <th colspan="2" style="background: #f3f4f6;"><input type="text" id="group_2" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="ì…íšŒì"></th>
        </tr>
        <tr>
          <th><input type="text" id="title_1" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="ë‹´ë‹¹"></th>
          <th><input type="text" id="title_2" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="íŒ€ì¥"></th>
          <th><input type="text" id="title_3" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="ê³¼ì¥"></th>
          <th><input type="text" id="title_4" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="ë‹´ë‹¹"></th>
          <th><input type="text" id="title_5" style="text-align: center; width: 100%; border: none; background: transparent; font-weight: bold;" value="ì—…ì²´"></th>
        </tr>
        <tr>
          <td><input type="text" id="sign_1" class="center" placeholder="(ì¸)"></td>
          <td><input type="text" id="sign_2" class="center" placeholder="(ì¸)"></td>
          <td><input type="text" id="sign_3" class="center" placeholder="(ì¸)"></td>
          <td><input type="text" id="sign_4" class="center" placeholder="(ì¸)"></td>
          <td><input type="text" id="sign_5" class="center" placeholder="(ì¸)"></td>
        </tr>
      </table>
    </div>

    <div class="help">
      <strong>ğŸ’¡ ê²€ìˆ˜ ì‹œ ìœ ì˜ì‚¬í•­</strong>
      <ul style="margin: 8px 0; padding-left: 20px;">
        <li>ê²€ìˆ˜ëŠ” ê³„ì•½ì„œ, ì„¤ê³„ì„œ, ì‹œë°©ì„œ ë“±ì— ë”°ë¼ ì´í–‰ ì—¬ë¶€ í™•ì¸</li>
        <li>ê²€ìˆ˜ì¡°ì„œëŠ” ëŒ€ê¸ˆì§€ê¸‰ì˜ ê·¼ê±° ì„œë¥˜ì´ë¯€ë¡œ ì •í™•íˆ ì‘ì„±</li>
        <li>ê²€ìˆ˜ í›„ <strong>5ì¼ ì´ë‚´</strong> ëŒ€ê¸ˆ ì§€ê¸‰ (ì§€ë°©ê³„ì•½ë²• ì‹œí–‰ë ¹ ì œ108ì¡°)</li>
        <li>ë¶ˆí•©ê²© ì‹œ í•˜ì ë³´ìˆ˜ ìš”ì²­ í›„ ì¬ê²€ìˆ˜ ì‹¤ì‹œ</li>
        <li><strong>Wordì €ì¥</strong>: .docx íŒŒì¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤ (í•œê¸€ HWPì—ì„œ ì—´ê¸° ê°€ëŠ¥)</li>
      </ul>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>
  <script>
    function updateResult() {
      const result = document.querySelector('input[name="final_result"]:checked');
      const box = document.getElementById('result-box');
      box.classList.remove('result-pass', 'result-fail', 'result-pending');

      if (result) {
        if (result.value === 'pass') {
          box.classList.add('result-pass');
        } else {
          box.classList.add('result-fail');
        }
      } else {
        box.classList.add('result-pending');
      }
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = 'toast success show';
      setTimeout(() => toast.classList.remove('show'), 2000);
    }

    function getFormData() {
      const data = {};
      document.querySelectorAll('input, textarea, select').forEach(el => {
        if (el.id) {
          data[el.id] = el.value;
        } else if (el.name === 'final_result' && el.checked) {
          data.final_result = el.value;
        }
      });
      return data;
    }

    function setFormData(data) {
      document.querySelectorAll('input, textarea, select').forEach(el => {
        if (el.id && data[el.id] !== undefined) {
          el.value = data[el.id];
        }
      });
      if (data.final_result) {
        document.querySelector(`input[name="final_result"][value="${data.final_result}"]`).checked = true;
        updateResult();
      }
    }

    function saveForm() {
      localStorage.setItem('ê²€ìˆ˜ì¡°ì„œ', JSON.stringify(getFormData()));
      showToast('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
    }

    function loadForm() {
      const saved = localStorage.getItem('ê²€ìˆ˜ì¡°ì„œ');
      if (saved) {
        setFormData(JSON.parse(saved));
        showToast('ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!');
      } else {
        showToast('ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
      }
    }

    function clearForm() {
      if (confirm('ëª¨ë“  ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        const defaults = { group_1: 'ê²€ìˆ˜ì', group_2: 'ì…íšŒì', title_1: 'ë‹´ë‹¹', title_2: 'íŒ€ì¥', title_3: 'ê³¼ì¥', title_4: 'ë‹´ë‹¹', title_5: 'ì—…ì²´' };
        document.querySelectorAll('input, textarea, select').forEach(el => {
          if (el.type === 'radio') el.checked = false;
          else if (defaults[el.id]) el.value = defaults[el.id];
          else el.value = '';
        });
        updateResult();
        showToast('ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }

    function formatNumber(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    async function downloadAsDocx() {
      const data = getFormData();
      const { Document, Packer, Paragraph, TextRun, AlignmentType } = docx;

      // ê²€ìˆ˜ ë‚´ì—­
      const items = [];
      for (let i = 1; i <= 5; i++) {
        if (data[`item_${i}_name`]) {
          const result = data[`item_${i}_result`] === 'pass' ? 'í•©ê²©' : data[`item_${i}_result`] === 'fail' ? 'ë¶ˆí•©ê²©' : '-';
          items.push(new Paragraph({
            children: [new TextRun({
              text: `${i}. ${data[`item_${i}_name`]} - ê³„ì•½:${data[`item_${i}_contract`] || 0} / ë‚©í’ˆ:${data[`item_${i}_delivery`] || 0} / ê²€ìˆ˜:${data[`item_${i}_inspect`] || 0} [${result}]`,
              size: 22
            })],
            spacing: { after: 100 }
          }));
        }
      }

      const finalResult = data.final_result === 'pass' ? 'í•©ê²©' : data.final_result === 'fail' ? 'ë¶ˆí•©ê²©' : 'ë¯¸ì •';

      const doc = new Document({
        sections: [{
          properties: {},
          children: [
            new Paragraph({
              children: [new TextRun({ text: 'ê²€ ìˆ˜ ì¡° ì„œ', bold: true, size: 40 })],
              alignment: AlignmentType.CENTER,
              spacing: { after: 400 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ê³„ì•½ê±´ëª…: ${data.contract_name || ''}`, size: 24 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ê³„ì•½ë²ˆí˜¸: ${data.contract_number || ''}`, size: 22 })],
              spacing: { after: 100 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ê³„ì•½ê¸ˆì•¡: ${formatNumber(data.contract_amount || 0)}ì›`, size: 22 })],
              spacing: { after: 100 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ê³„ì•½ìƒëŒ€ì: ${data.contractor || ''} (ëŒ€í‘œ: ${data.contractor_ceo || ''})`, size: 22 })],
              spacing: { after: 100 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ê³„ì•½ê¸°ê°„: ${data.contract_start || ''} ~ ${data.contract_end || ''}`, size: 22 })],
              spacing: { after: 100 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ë‚©í’ˆì¼: ${data.delivery_date || ''}  ê²€ìˆ˜ì¼: ${data.inspection_date || ''}`, size: 22 })],
              spacing: { after: 300 }
            }),
            new Paragraph({
              children: [new TextRun({ text: 'ê²€ìˆ˜ ë‚´ì—­', bold: true, size: 24 })],
              spacing: { after: 200 }
            }),
            ...items,
            new Paragraph({
              children: [new TextRun({ text: '', size: 22 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: 'ê²€ìˆ˜ ì˜ê²¬', bold: true, size: 24 })],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: data.inspection_opinion || '', size: 22 })],
              spacing: { after: 300 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `ìµœì¢… ê²€ìˆ˜ê²°ê³¼: ${finalResult}`, bold: true, size: 28 })],
              alignment: AlignmentType.CENTER,
              spacing: { after: 400 }
            }),
            new Paragraph({
              children: [new TextRun({ text: 'ìœ„ì™€ ê°™ì´ ê²€ìˆ˜í•˜ì˜€ìŒì„ í™•ì¸í•©ë‹ˆë‹¤.', size: 22 })],
              alignment: AlignmentType.CENTER,
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `${data.year || ''}ë…„ ${data.month || ''}ì›” ${data.day || ''}ì¼`, size: 22 })],
              alignment: AlignmentType.CENTER,
              spacing: { after: 400 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `[${data.group_1 || 'ê²€ìˆ˜ì'}]`, bold: true, size: 22 })],
              spacing: { after: 100 }
            }),
            new Paragraph({
              children: [
                new TextRun({ text: `${data.title_1 || 'ë‹´ë‹¹'}: ${data.sign_1 || '(ì¸)'}  `, size: 22 }),
                new TextRun({ text: `${data.title_2 || 'íŒ€ì¥'}: ${data.sign_2 || '(ì¸)'}  `, size: 22 }),
                new TextRun({ text: `${data.title_3 || 'ê³¼ì¥'}: ${data.sign_3 || '(ì¸)'}`, size: 22 })
              ],
              spacing: { after: 200 }
            }),
            new Paragraph({
              children: [new TextRun({ text: `[${data.group_2 || 'ì…íšŒì'}]`, bold: true, size: 22 })],
              spacing: { after: 100 }
            }),
            new Paragraph({
              children: [
                new TextRun({ text: `${data.title_4 || 'ë‹´ë‹¹'}: ${data.sign_4 || '(ì¸)'}  `, size: 22 }),
                new TextRun({ text: `${data.title_5 || 'ì—…ì²´'}: ${data.sign_5 || '(ì¸)'}`, size: 22 })
              ]
            })
          ]
        }]
      });

      const blob = await Packer.toBlob(doc);
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `ê²€ìˆ˜ì¡°ì„œ_${data.contract_name || 'ì‘ì„±ì¤‘'}.docx`;
      a.click();
      URL.revokeObjectURL(url);
      showToast('Word íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
    }
  </script>
</body>
</html>
